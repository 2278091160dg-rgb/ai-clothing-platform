# ğŸ”§ AIæœè£…å¹³å° - å®Œæ•´é…ç½®æŒ‡å—ï¼ˆæŠ€æœ¯å°ç™½ç‰ˆï¼‰

## ğŸ“… æ–‡æ¡£ç‰ˆæœ¬ï¼šv1.0

## ğŸ“… æ›´æ–°æ—¥æœŸï¼š2026-01-29

## ğŸ¯ é€‚ç”¨å¯¹è±¡ï¼šæŠ€æœ¯å°ç™½ç”¨æˆ·

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ](#1-ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ)
2. [ç¯å¢ƒå‡†å¤‡æ¸…å•](#2-ç¯å¢ƒå‡†å¤‡æ¸…å•)
3. [é£ä¹¦å¤šç»´è¡¨æ ¼é…ç½®](#3-é£ä¹¦å¤šç»´è¡¨æ ¼é…ç½®)
4. [N8Nå·¥ä½œæµé…ç½®](#4-n8nå·¥ä½œæµé…ç½®)
5. [å‰ç«¯Webé…ç½®](#5-å‰ç«¯webé…ç½®)
6. [ä¸‰ç«¯è”åŠ¨éªŒè¯](#6-ä¸‰ç«¯è”åŠ¨éªŒè¯)
7. [å¸¸è§é—®é¢˜æ’æŸ¥](#7-å¸¸è§é—®é¢˜æ’æŸ¥)
8. [å®Œæ•´å·¥ä½œæµJSON](#8-å®Œæ•´å·¥ä½œæµjson)

---

## 1. ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

### 1.1 ä¸‰ç«¯æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AIæœè£…å¹³å° - åŒè½¨æ¶æ„                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    è½¨é“Aï¼šå‰ç«¯ â†’ é£ä¹¦ â†’ N8N                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚Webå‰ç«¯  â”‚ â†’ â”‚é£ä¹¦è¡¨æ ¼ â”‚ â†’ â”‚  N8N   â”‚ â†’ â”‚å›è°ƒå‰ç«¯  â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚       â”‚              â”‚              â”‚              â”‚          â”‚  â”‚
â”‚  â”‚       â”‚              â–¼              â–¼              â–¼          â”‚  â”‚
â”‚  â”‚       â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚äº‹ä»¶ç³»ç»Ÿ â”‚â†â”€â”€â”‚N8Nå›è°ƒ  â”‚â†â”€â”€â”‚çŠ¶æ€æ›´æ–°  â”‚   â”‚  â”‚
â”‚  â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    è½¨é“Bï¼šé£ä¹¦ â†’ N8N â†’ é£ä¹¦                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚  â”‚
â”‚  â”‚  â”‚é£ä¹¦è¡¨æ ¼ â”‚ â†’ â”‚  N8N   â”‚ â†’ â”‚é£ä¹¦æ›´æ–°  â”‚                 â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ•°æ®æµè¯¦è§£

#### å‰ç«¯è½¨é“å®Œæ•´æµç¨‹

```
ç”¨æˆ·åœ¨Webç«¯æ“ä½œ
    â†“
1. ä¸Šä¼ å›¾ç‰‡ â†’ è½¬Base64 â†’ è¿”å›dataUrl
    â†“
2. æäº¤ä»»åŠ¡ â†’ POST /api/tasks
    â†“
3. åç«¯åˆ›å»ºæ•°æ®åº“è®°å½•ï¼ˆstatus=pendingï¼‰
    â†“
4. ã€åŒæ—¶è§¦å‘ä¸¤ä¸ªåŠ¨ä½œã€‘
    â”œâ”€â†’ äº‹ä»¶ç³»ç»Ÿ â†’ é£ä¹¦åˆ›å»ºè®°å½•ï¼ˆä¿å­˜feishuRecordIdï¼‰
    â””â”€â†’ N8Nå·¥ä½œæµ â†’ å¤„ç†ç”Ÿæˆ
    â†“
5. N8Nå®Œæˆ â†’ å›è°ƒ /api/webhooks/n8n/callback
    â†“
6. ã€åŒæ—¶è§¦å‘ä¸¤ä¸ªåŠ¨ä½œã€‘
    â”œâ”€â†’ æ›´æ–°æ•°æ®åº“ï¼ˆstatus=completedï¼‰
    â””â”€â†’ äº‹ä»¶ç³»ç»Ÿ â†’ é£ä¹¦æ›´æ–°è®°å½•
    â†“
7. å‰ç«¯è½®è¯¢/WebSocket â†’ æ˜¾ç¤ºç»“æœ
```

#### é£ä¹¦è½¨é“å®Œæ•´æµç¨‹

```
ç”¨æˆ·åœ¨é£ä¹¦è¡¨æ ¼æ“ä½œ
    â†“
1. å¡«å†™ï¼šæç¤ºè¯ã€å•†å“å›¾ã€åœºæ™¯å›¾ï¼ˆå¯é€‰ï¼‰
    â†“
2. ç‚¹å‡»"ç‚¹å‡»æŒ‰é’®" â†’ è§¦å‘é£ä¹¦è‡ªåŠ¨åŒ–
    â†“
3. é£ä¹¦è‡ªåŠ¨åŒ– â†’ POST N8N Webhook
    â†“
4. N8Nè¯»å–é£ä¹¦è®°å½• â†’ ä¸‹è½½å›¾ç‰‡ â†’ è°ƒç”¨AIç”Ÿæˆ
    â†“
5. N8Nä¸Šä¼ ç»“æœåˆ°é£ä¹¦ â†’ æ›´æ–°è®°å½•
    â†“
6. é£ä¹¦è¡¨æ ¼æ˜¾ç¤ºå®ŒæˆçŠ¶æ€
```

### 1.3 å…³é”®æ¦‚å¿µ

| æ¦‚å¿µ           | è¯´æ˜                   | ä¸¾ä¾‹                              |
| -------------- | ---------------------- | --------------------------------- |
| **Webhook**    | N8Nçš„æ¥æ”¶æ¥å£          | `https://n8n.xxx.com/webhook/xxx` |
| **App Token**  | é£ä¹¦è¡¨æ ¼çš„å”¯ä¸€æ ‡è¯†     | `app_abc123`                      |
| **Table ID**   | é£ä¹¦è¡¨æ ¼ä¸­æ•°æ®è¡¨çš„æ ‡è¯† | `tbl_xyz456`                      |
| **Record ID**  | é£ä¹¦è®°å½•çš„å”¯ä¸€æ ‡è¯†     | `rec_789`                         |
| **File Token** | é£ä¹¦å›¾ç‰‡çš„å”¯ä¸€æ ‡è¯†     | `vbox_abc`                        |

---

## 2. ç¯å¢ƒå‡†å¤‡æ¸…å•

### 2.1 éœ€è¦çš„è´¦å·å’ŒæœåŠ¡

| æœåŠ¡             | ç”¨é€”                     | æ˜¯å¦å¿…éœ€ | è·å–æ–¹å¼                |
| ---------------- | ------------------------ | -------- | ----------------------- |
| **é£ä¹¦å¼€æ”¾å¹³å°** | å­˜å‚¨æ•°æ®å’Œè§¦å‘è‡ªåŠ¨åŒ–     | âœ… å¿…éœ€  | https://open.feishu.cn  |
| **N8N**          | å·¥ä½œæµå¼•æ“               | âœ… å¿…éœ€  | https://n8n.io          |
| **DeerAPI**      | AIå›¾ç‰‡ç”ŸæˆæœåŠ¡           | âœ… å¿…éœ€  | https://api.deerapi.com |
| **Vercel**       | å‰ç«¯éƒ¨ç½²ï¼ˆæ¨èï¼‰         | âœ… å¿…éœ€  | https://vercel.com      |
| **Supabase**     | PostgreSQLæ•°æ®åº“ï¼ˆæ¨èï¼‰ | âœ… å¿…éœ€  | https://supabase.com    |

### 2.2 éœ€è¦å‡†å¤‡çš„å‡­è¯

| å‡­è¯            | ç”¨é€”           | åœ¨å“ªé‡Œé…ç½®     |
| --------------- | -------------- | -------------- |
| é£ä¹¦ App ID     | é£ä¹¦åº”ç”¨è®¤è¯   | N8N + ç¯å¢ƒå˜é‡ |
| é£ä¹¦ App Secret | é£ä¹¦åº”ç”¨è®¤è¯   | N8N + ç¯å¢ƒå˜é‡ |
| é£ä¹¦ App Token  | é£ä¹¦è¡¨æ ¼æ ‡è¯†   | N8N + ç¯å¢ƒå˜é‡ |
| é£ä¹¦ Table ID   | é£ä¹¦æ•°æ®è¡¨æ ‡è¯† | N8N + ç¯å¢ƒå˜é‡ |
| DeerAPI Key     | AIç”ŸæˆæœåŠ¡     | N8N            |
| N8N API Key     | å›è°ƒè®¤è¯       | ç¯å¢ƒå˜é‡       |
| æ•°æ®åº“è¿æ¥ä¸²    | PostgreSQL     | ç¯å¢ƒå˜é‡       |
| ç™»å½•å¯†ç         | Webç«¯è®¿é—®ä¿æŠ¤  | ç¯å¢ƒå˜é‡       |

### 2.3 å‰ç«¯è·å–è¿™äº›ä¿¡æ¯

#### è·å–é£ä¹¦ App Token å’Œ Table ID

1. æ‰“å¼€ä½ çš„é£ä¹¦å¤šç»´è¡¨æ ¼
2. æŸ¥çœ‹æµè§ˆå™¨åœ°å€æ ï¼Œä¾‹å¦‚ï¼š
   ```
   https://xxx.feishu.cn/base/app_abc123def456/?table=tbl_xyz789
   ```
3. **App Token** = `app_abc123def456`
4. **Table ID** = `tbl_xyz789`

#### è·å–é£ä¹¦ App ID å’Œ App Secret

1. è®¿é—®é£ä¹¦å¼€æ”¾å¹³å°ï¼šhttps://open.feishu.cn
2. åˆ›å»ºä¼ä¸šè‡ªå»ºåº”ç”¨
3. åœ¨æƒé™ç®¡ç†ä¸­æ·»åŠ ï¼š
   - **bitable:app**ï¼šè·å–å¤šç»´è¡¨æ ¼ä¿¡æ¯
   - **bitable:app:readonly**ï¼šè¯»å–å¤šç»´è¡¨æ ¼
   - **bitable:app:write**ï¼šå†™å…¥å¤šç»´è¡¨æ ¼
4. åœ¨å‡­è¯ç®¡ç†ä¸­è·å– App ID å’Œ App Secret

---

## 3. é£ä¹¦å¤šç»´è¡¨æ ¼é…ç½®

### 3.1 å¿…é¡»å­—æ®µï¼ˆ11ä¸ªï¼‰

#### å­—æ®µ1ï¼šæç¤ºè¯

```
å­—æ®µç±»å‹ï¼šå¤šè¡Œæ–‡æœ¬
å­—æ®µåç§°ï¼šæç¤ºè¯
å­—æ®µè¯´æ˜ï¼šAIç”Ÿæˆçš„æç¤ºè¯æè¿°
æ˜¯å¦å¿…å¡«ï¼šæ˜¯
é»˜è®¤å€¼ï¼šæ— 
```

#### å­—æ®µ2ï¼šå•†å“å›¾ç‰‡

```
å­—æ®µç±»å‹ï¼šé™„ä»¶
å­—æ®µåç§°ï¼šå•†å“å›¾ç‰‡
å­—æ®µè¯´æ˜ï¼šç¬¬ä¸€å¼ å›¾ï¼šäº§å“å›¾
æ˜¯å¦å¿…å¡«ï¼šæ˜¯
æ–‡ä»¶é™åˆ¶ï¼šä»…å›¾ç‰‡
```

#### å­—æ®µ3ï¼šåœºæ™¯å›¾

```
å­—æ®µç±»å‹ï¼šé™„ä»¶
å­—æ®µåç§°ï¼šåœºæ™¯å›¾
å­—æ®µè¯´æ˜ï¼šç¬¬äºŒå¼ å›¾ï¼šå‚è€ƒåœºæ™¯ï¼ˆå¯é€‰ï¼‰
æ˜¯å¦å¿…å¡«ï¼šå¦
æ–‡ä»¶é™åˆ¶ï¼šä»…å›¾ç‰‡
```

#### å­—æ®µ4ï¼šç‚¹å‡»æŒ‰é’®

```
å­—æ®µç±»å‹ï¼šæŒ‰é’®
å­—æ®µåç§°ï¼šç‚¹å‡»æŒ‰é’®
æŒ‰é’®æ–‡æœ¬ï¼šç‚¹å‡»æŒ‰é’®
æ˜¯å¦å¿…å¡«ï¼šæ˜¯
è§¦å‘ï¼šè‡ªåŠ¨åŒ–ï¼ˆåç»­é…ç½®ï¼‰
```

#### å­—æ®µ5ï¼šç”Ÿæˆç»“æœ

```
å­—æ®µç±»å‹ï¼šé™„ä»¶
å­—æ®µåç§°ï¼šç”Ÿæˆç»“æœ
å­—æ®µè¯´æ˜ï¼šAIç”Ÿæˆçš„ç»“æœå›¾ç‰‡ï¼Œæ”¯æŒå¤šå¼ 
æ˜¯å¦å¿…å¡«ï¼šå¦ï¼ˆè‡ªåŠ¨å†™å…¥ï¼‰
```

#### å­—æ®µ6ï¼šçŠ¶æ€

```
å­—æ®µç±»å‹ï¼šå•é€‰
å­—æ®µåç§°ï¼šçŠ¶æ€
æ˜¯å¦å¿…å¡«ï¼šå¦
é€‰é¡¹ï¼š
  - å¾…å¤„ç†ï¼ˆé»˜è®¤ï¼‰
  - å¤„ç†ä¸­
  - å·²å®Œæˆ
  - ç”Ÿæˆå¤±è´¥
```

#### å­—æ®µ7ï¼šAIæ¨¡å‹

```
å­—æ®µç±»å‹ï¼šå•é€‰
å­—æ®µåç§°ï¼šAIæ¨¡å‹
æ˜¯å¦å¿…å¡«ï¼šå¦
é€‰é¡¹ï¼š
  - Gemini-3-Pro-Imageï¼ˆé»˜è®¤ï¼‰
  - Gemini-2-Flash
  - FLUX.1
```

#### å­—æ®µ8ï¼šå°ºå¯¸æ¯”ä¾‹

```
å­—æ®µç±»å‹ï¼šå•é€‰
å­—æ®µåç§°ï¼šå°ºå¯¸æ¯”ä¾‹
æ˜¯å¦å¿…å¡«ï¼šå¦
é€‰é¡¹ï¼š
  - 1:1ï¼ˆ1024x1024ï¼‰
  - 3:4ï¼ˆ768x1024ï¼Œé»˜è®¤ï¼‰
  - 16:9ï¼ˆ1344x768ï¼‰
  - 9:16ï¼ˆ768x1344ï¼‰
```

#### å­—æ®µ9ï¼šç”Ÿæˆæ•°é‡

```
å­—æ®µç±»å‹ï¼šæ•°å­—
å­—æ®µåç§°ï¼šç”Ÿæˆæ•°é‡
æ˜¯å¦å¿…å¡«ï¼šå¦
é»˜è®¤å€¼ï¼š4
æœ€å°å€¼ï¼š1
æœ€å¤§å€¼ï¼š8
```

#### å­—æ®µ10ï¼šæ•°æ®æ¥æº

```
å­—æ®µç±»å‹ï¼šå•é€‰
å­—æ®µåç§°ï¼šæ•°æ®æ¥æº
æ˜¯å¦å¿…å¡«ï¼šæ˜¯
é»˜è®¤å€¼ï¼šğŸŒ å‰ç«¯ç”¨æˆ·
æƒé™ï¼šåªè¯»ï¼ˆç³»ç»Ÿè‡ªåŠ¨å¡«å……ï¼‰
é€‰é¡¹ï¼š
  - ğŸŒ å‰ç«¯ç”¨æˆ·
  - ğŸ“Š é£ä¹¦ç”¨æˆ·
  - ğŸ¤– APIè‡ªåŠ¨
```

#### å­—æ®µ11ï¼šåŒæ­¥çŠ¶æ€

```
å­—æ®µç±»å‹ï¼šå•é€‰
å­—æ®µåç§°ï¼šåŒæ­¥çŠ¶æ€
æ˜¯å¦å¿…å¡«ï¼šæ˜¯
é»˜è®¤å€¼ï¼šâœ… å·²åŒæ­¥
æƒé™ï¼šåªè¯»ï¼ˆç³»ç»Ÿè‡ªåŠ¨å¡«å……ï¼‰
é€‰é¡¹ï¼š
  - âœ… å·²åŒæ­¥
  - ğŸ”„ åŒæ­¥ä¸­
  - âš ï¸ å†²çª
  - âŒ å¤±è´¥
```

### 3.2 é£ä¹¦è‡ªåŠ¨åŒ–é…ç½®

#### è‡ªåŠ¨åŒ–1ï¼šç‚¹å‡»æŒ‰é’®è§¦å‘N8N

```
è‡ªåŠ¨åŒ–åç§°ï¼šAIåœºæ™¯å›¾ç”Ÿæˆ-è§¦å‘N8N

è§¦å‘å™¨ï¼š
  ç±»å‹ï¼šæŒ‰é’®è¢«ç‚¹å‡»
  å­—æ®µï¼šç‚¹å‡»æŒ‰é’®

æ“ä½œï¼š
  ç±»å‹ï¼šå‘é€Webhookè¯·æ±‚
  URLï¼šä»N8Nçš„Webhookè§¦å‘å™¨1èŠ‚ç‚¹å¤åˆ¶
  æ–¹æ³•ï¼šPOST
  Headersï¼š
    Content-Type: application/json
  Bodyï¼ˆJSONæ ¼å¼ï¼‰ï¼š
    {
      "app_token": è§¦å‘è®°å½•.app_token,
      "table_id": è§¦å‘è®°å½•.table_id,
      "record_id": è§¦å‘è®°å½•.record_id
    }
```

**å¦‚ä½•è·å–Webhook URLï¼š**

1. åœ¨N8Nä¸­æ‰“å¼€å·¥ä½œæµ
2. ç‚¹å‡»"Webhookè§¦å‘å™¨1"èŠ‚ç‚¹
3. æŸ¥çœ‹"Production URL"
4. å¤åˆ¶URLï¼ˆä¾‹å¦‚ï¼š`https://n8n.xxx.com/webhook/feishu-trigger-v3`ï¼‰

### 3.3 å­—æ®µæƒé™é…ç½®

| å­—æ®µåç§° | é£ä¹¦ç”¨æˆ·æƒé™ | ç³»ç»Ÿæƒé™ |
| -------- | ------------ | -------- |
| æç¤ºè¯   | å¯ç¼–è¾‘       | å¯ç¼–è¾‘   |
| å•†å“å›¾ç‰‡ | å¯ç¼–è¾‘       | å¯ç¼–è¾‘   |
| åœºæ™¯å›¾   | å¯ç¼–è¾‘       | å¯ç¼–è¾‘   |
| AIæ¨¡å‹   | å¯ç¼–è¾‘       | å¯ç¼–è¾‘   |
| å°ºå¯¸æ¯”ä¾‹ | å¯ç¼–è¾‘       | å¯ç¼–è¾‘   |
| ç”Ÿæˆæ•°é‡ | å¯ç¼–è¾‘       | å¯ç¼–è¾‘   |
| ç‚¹å‡»æŒ‰é’® | å¯ç‚¹å‡»       | -        |
| ç”Ÿæˆç»“æœ | åªè¯»         | å¯ç¼–è¾‘   |
| çŠ¶æ€     | åªè¯»         | å¯ç¼–è¾‘   |
| æ•°æ®æ¥æº | åªè¯»         | å¯ç¼–è¾‘   |
| åŒæ­¥çŠ¶æ€ | åªè¯»         | å¯ç¼–è¾‘   |

---

## 4. N8Nå·¥ä½œæµé…ç½®

### 4.1 N8Nç¯å¢ƒå˜é‡é…ç½®

åœ¨N8Nä¸­é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```bash
# é£ä¹¦é…ç½®
FEISHU_APP_TOKEN=app_ä½ çš„AppToken
FEISHU_TABLE_ID=tbl_ä½ çš„TableID

# N8Nå›è°ƒé…ç½®ï¼ˆå¯é€‰ï¼Œç”¨äºè®¤è¯ï¼‰
N8N_API_KEY=n8n-callback-secret-key-2024
```

**é…ç½®æ–¹æ³•ï¼š**

**æ–¹æ³•1ï¼šä½¿ç”¨ .env æ–‡ä»¶**

```bash
# åœ¨N8Nå®‰è£…ç›®å½•ä¸‹åˆ›å»º .env æ–‡ä»¶
FEISHU_APP_TOKEN=app_abc123
FEISHU_TABLE_ID=tbl_xyz456
N8N_API_KEY=n8n-callback-secret-key-2024
```

**æ–¹æ³•2ï¼šä½¿ç”¨ Docker**

```bash
docker run -d \
  --name n8n \
  -p 5678:5678 \
  -e FEISHU_APP_TOKEN=app_abc123 \
  -e FEISHU_TABLE_ID=tbl_xyz456 \
  -e N8N_API_KEY=n8n-callback-secret-key-2024 \
  -v ~/.n8n:/home/node/.n8n \
  n8nio/n8n
```

**æ–¹æ³•3ï¼šä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡**

```bash
export FEISHU_APP_TOKEN=app_abc123
export FEISHU_TABLE_ID=tbl_xyz456
export N8N_API_KEY=n8n-callback-secret-key-2024
```

### 4.2 N8Nå‡­è¯é…ç½®

#### å‡­è¯1ï¼šFeishu Credentials

```
å‡­è¯ç±»å‹ï¼šFeishu Credentials API
å‡­è¯åç§°ï¼šFeishu Credentials account 3

App IDï¼šä½ çš„é£ä¹¦App ID
App Secretï¼šä½ çš„é£ä¹¦App Secret
```

#### å‡­è¯2ï¼šDeerAPI

```
å‡­è¯ç±»å‹ï¼šHeader Auth
å‡­è¯åç§°ï¼šDeerAPI account 2

Header Nameï¼šAuthorization
Header Valueï¼šBearer sk-ä½ çš„DeerAPI_Key
```

**æˆ–è€…ï¼š**

```
å‡­è¯ç±»å‹ï¼šGeneric Credential Type
å‡­è¯åç§°ï¼šDeerAPI account

API Keyï¼šsk-ä½ çš„DeerAPI_Key
```

#### å‡­è¯3ï¼šHeader Auth account 2ï¼ˆç”¨äºå›è°ƒï¼‰

```
å‡­è¯ç±»å‹ï¼šHeader Auth
å‡­è¯åç§°ï¼šHeader Auth account 2

Header Nameï¼šx-n8n-api-key
Header Valueï¼šn8n-callback-secret-key-2024
```

### 4.3 å¯¼å…¥å·¥ä½œæµ

1. æ‰“å¼€N8Nç•Œé¢
2. ç‚¹å‡»å³ä¸Šè§’ **"+"** æŒ‰é’®
3. é€‰æ‹© **Import from File**
4. ä¸Šä¼ æ–‡ä»¶ï¼š`ai-clothing-platform-n8n-workflow-complete.json`
5. ç‚¹å‡» **Import**

### 4.4 æ¿€æ´»Webhook

**Webhookè§¦å‘å™¨ï¼ˆå‰ç«¯è½¨é“ï¼‰ï¼š**

1. ç‚¹å‡»èŠ‚ç‚¹"Webhookè§¦å‘å™¨"
2. ç‚¹å‡»"Listen for Test Event"
3. å¤åˆ¶"Test URL"æˆ–"Production URL"

**Webhookè§¦å‘å™¨1ï¼ˆé£ä¹¦è½¨é“ï¼‰ï¼š**

1. ç‚¹å‡»èŠ‚ç‚¹"Webhookè§¦å‘å™¨1"
2. ç‚¹å‡»"Listen for Test Event"
3. å¤åˆ¶"Production URL"ï¼ˆç”¨äºé£ä¹¦è‡ªåŠ¨åŒ–ï¼‰

---

## 5. å‰ç«¯Webé…ç½®

### 5.1 ç¯å¢ƒå˜é‡é…ç½®

åœ¨ `.env.local` æ–‡ä»¶ä¸­é…ç½®ï¼š

```bash
# æ•°æ®åº“é…ç½®
DATABASE_URL="postgresql://postgres.xxx:password@aws-1-ap-south-1.pooler.supabase.com:5432/postgres"

# é£ä¹¦é…ç½®
FEISHU_APP_ID=ä½ çš„é£ä¹¦AppID
FEISHU_APP_SECRET=ä½ çš„é£ä¹¦AppSecret
FEISHU_BITABLE_APP_TOKEN=ä½ çš„é£ä¹¦AppToken
FEISHU_BITABLE_TABLE_ID=ä½ çš„é£ä¹¦TableID

# N8Né…ç½®
N8N_WEBHOOK_URL=https://ä½ çš„N8Nåœ°å€/webhook/ai-clothing-generation
N8N_API_KEY=n8n-callback-secret-key-2024

# åº”ç”¨é…ç½®
NEXT_PUBLIC_APP_URL=https://ä½ çš„åº”ç”¨åœ°å€

# ç™»å½•å¯†ç ï¼ˆå¯é€‰ï¼‰
ACCESS_PASSWORD=ä½ çš„ç™»å½•å¯†ç 
```

### 5.2 éƒ¨ç½²åˆ°Vercel

1. è¿æ¥GitHubä»“åº“
2. å¯¼å…¥é¡¹ç›®åˆ°Vercel
3. é…ç½®ç¯å¢ƒå˜é‡
4. éƒ¨ç½²

---

## 6. ä¸‰ç«¯è”åŠ¨éªŒè¯

### 6.1 éªŒè¯1ï¼šå‰ç«¯è½¨é“

**æµ‹è¯•æ­¥éª¤ï¼š**

1. æ‰“å¼€Webå‰ç«¯ï¼šhttps://ä½ çš„åº”ç”¨åœ°å€
2. è¾“å…¥ç™»å½•å¯†ç ï¼ˆå¦‚æœè®¾ç½®äº†ï¼‰
3. å¡«å†™ï¼š
   - æç¤ºè¯ï¼š`æ—¶å°šæ¨¡ç‰¹åœ¨ç¹åè¡—å¤´`
   - ä¸Šä¼ å•†å“å›¾ç‰‡
   - ï¼ˆå¯é€‰ï¼‰ä¸Šä¼ åœºæ™¯å›¾
   - AIæ¨¡å‹ï¼šä¿æŒé»˜è®¤
   - å°ºå¯¸æ¯”ä¾‹ï¼šä¿æŒé»˜è®¤
   - ç”Ÿæˆæ•°é‡ï¼šä¿æŒé»˜è®¤
4. ç‚¹å‡»"ç”Ÿæˆ"æŒ‰é’®

**éªŒè¯ç‚¹ï¼š**

- âœ… å‰ç«¯æ˜¾ç¤º"ä»»åŠ¡åˆ›å»ºæˆåŠŸ"
- âœ… é£ä¹¦è¡¨æ ¼ä¸­å‡ºç°æ–°è®°å½•
- âœ… é£ä¹¦è®°å½•çš„"æ•°æ®æ¥æº"æ˜¾ç¤º"ğŸŒ å‰ç«¯ç”¨æˆ·"
- âœ… 30-60ç§’åï¼Œé£ä¹¦è®°å½•çš„"ç”Ÿæˆç»“æœ"å‡ºç°å›¾ç‰‡
- âœ… é£ä¹¦è®°å½•çš„"çŠ¶æ€"å˜ä¸º"å·²å®Œæˆ"

### 6.2 éªŒè¯2ï¼šé£ä¹¦è½¨é“

**æµ‹è¯•æ­¥éª¤ï¼š**

1. æ‰“å¼€é£ä¹¦å¤šç»´è¡¨æ ¼
2. æ–°å»ºè®°å½•
3. å¡«å†™ï¼š
   - æç¤ºè¯ï¼š`æ—¶å°šæ¨¡ç‰¹åœ¨ç¹åè¡—å¤´`
   - å•†å“å›¾ç‰‡ï¼šä¸Šä¼ ä¸€å¼ å›¾ç‰‡
   - ï¼ˆå¯é€‰ï¼‰åœºæ™¯å›¾ï¼šä¸Šä¼ ä¸€å¼ å›¾ç‰‡
4. ç‚¹å‡»"ç‚¹å‡»æŒ‰é’®"

**éªŒè¯ç‚¹ï¼š**

- âœ… é£ä¹¦è®°å½•çš„"çŠ¶æ€"å˜ä¸º"å¤„ç†ä¸­"
- âœ… 30-60ç§’åï¼Œ"ç”Ÿæˆç»“æœ"å‡ºç°å›¾ç‰‡
- âœ… "çŠ¶æ€"å˜ä¸º"å·²å®Œæˆ"

### 6.3 éªŒè¯3ï¼šæ•°æ®åŒæ­¥

**éªŒè¯æ­¥éª¤ï¼š**

1. ä»å‰ç«¯åˆ›å»ºä¸€ä¸ªä»»åŠ¡
2. åœ¨é£ä¹¦è¡¨æ ¼ä¸­æ‰¾åˆ°å¯¹åº”çš„è®°å½•
3. ä¿®æ”¹é£ä¹¦è®°å½•çš„"æç¤ºè¯"
4. è§‚å¯Ÿå‰ç«¯æ˜¯å¦æœ‰å˜åŒ–

**éªŒè¯ç‚¹ï¼š**

- âœ… å‰ç«¯å’Œé£ä¹¦æ•°æ®ä¿æŒåŒæ­¥
- âœ… ä¸€æ–¹ä¿®æ”¹ï¼Œå¦ä¸€æ–¹èƒ½çœ‹åˆ°

---

## 7. å¸¸è§é—®é¢˜æ’æŸ¥

### 7.1 å‰ç«¯åˆ›å»ºä»»åŠ¡åï¼Œé£ä¹¦æ²¡æœ‰è®°å½•

**å¯èƒ½åŸå› ï¼š**

1. **é£ä¹¦äº‹ä»¶ç›‘å¬å™¨æœªåˆå§‹åŒ–**
   - æ£€æŸ¥åç«¯æ—¥å¿—ï¼š`[FeishuListener] All listeners registered`
   - è§£å†³ï¼šé‡å¯å‰ç«¯æœåŠ¡

2. **é£ä¹¦å‡­è¯é…ç½®é”™è¯¯**
   - æ£€æŸ¥ç¯å¢ƒå˜é‡ï¼š`FEISHU_APP_ID`, `FEISHU_APP_SECRET`
   - æ£€æŸ¥æ—¥å¿—ï¼š`Feishu credentials not configured`
   - è§£å†³ï¼šæ›´æ–°ç¯å¢ƒå˜é‡å¹¶é‡å¯

3. **å›¾ç‰‡URLæ ¼å¼ä¸åŒ¹é…**
   - å‰ç«¯ä¸Šä¼ çš„æ˜¯Base64 dataUrl
   - é£ä¹¦éœ€è¦ file_token
   - è§£å†³ï¼šéœ€è¦å…ˆä¸Šä¼ å›¾ç‰‡åˆ°é£ä¹¦è·å–token

### 7.2 N8Nå·¥ä½œæµæ²¡æœ‰è§¦å‘

**å¯èƒ½åŸå› ï¼š**

1. **Webhook URLé…ç½®é”™è¯¯**
   - æ£€æŸ¥ç¯å¢ƒå˜é‡ï¼š`N8N_WEBHOOK_URL`
   - è§£å†³ï¼šç¡®ä¿URLå®Œæ•´ä¸”å¯è®¿é—®

2. **Webhookæœªæ¿€æ´»**
   - åœ¨N8Nä¸­æ£€æŸ¥WebhookèŠ‚ç‚¹æ˜¯å¦æ¿€æ´»
   - è§£å†³ï¼šç‚¹å‡»"Listen for Test Event"æ¿€æ´»

3. **ç½‘ç»œé—®é¢˜**
   - æ£€æŸ¥å‰åç«¯æ˜¯å¦åœ¨åŒä¸€ç½‘ç»œ
   - è§£å†³ï¼šç¡®ä¿ç½‘ç»œäº’é€š

### 7.3 é£ä¹¦è‡ªåŠ¨åŒ–æ²¡æœ‰è§¦å‘

**å¯èƒ½åŸå› ï¼š**

1. **è‡ªåŠ¨åŒ–æœªå¯ç”¨**
   - åœ¨é£ä¹¦ä¸­æ£€æŸ¥è‡ªåŠ¨åŒ–æ˜¯å¦å¯ç”¨
   - è§£å†³ï¼šç‚¹å‡»"å¯ç”¨"æŒ‰é’®

2. **Webhook URLé…ç½®é”™è¯¯**
   - æ£€æŸ¥é£ä¹¦è‡ªåŠ¨åŒ–ä¸­çš„URL
   - è§£å†³ï¼šä»N8Nå¤åˆ¶æ­£ç¡®çš„Production URL

3. **Bodyæ ¼å¼é”™è¯¯**
   - æ£€æŸ¥é£ä¹¦è‡ªåŠ¨åŒ–çš„Bodyæ ¼å¼
   - è§£å†³ï¼šç¡®ä¿JSONæ ¼å¼æ­£ç¡®

### 7.4 ç”Ÿæˆç»“æœæ²¡æœ‰å†™å…¥é£ä¹¦

**å¯èƒ½åŸå› ï¼š**

1. **é£ä¹¦å­—æ®µåç§°ä¸åŒ¹é…**
   - æ£€æŸ¥é£ä¹¦è¡¨æ ¼å­—æ®µåç§°
   - è§£å†³ï¼šç¡®ä¿å­—æ®µåç§°å®Œå…¨ä¸€è‡´

2. **æƒé™ä¸è¶³**
   - æ£€æŸ¥é£ä¹¦åº”ç”¨æƒé™
   - è§£å†³ï¼šç¡®ä¿æœ‰å†™å…¥æƒé™

3. **File Tokenæ— æ•ˆ**
   - æ£€æŸ¥ä¸Šä¼ çš„å›¾ç‰‡token
   - è§£å†³ï¼šç¡®ä¿tokenæ ¼å¼æ­£ç¡®

---

## 8. å®Œæ•´å·¥ä½œæµJSON

### 8.1 å·¥ä½œæµJSONæ–‡ä»¶

æ–‡ä»¶ä½ç½®ï¼š`docs/ai-clothing-platform-n8n-workflow-complete.json`

```json
{
  "name": "AIæœè£…å¹³å°-åŒè½¨å·¥ä½œæµ",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "ai-clothing-generation",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-frontend",
      "name": "Webhookè§¦å‘å™¨-å‰ç«¯",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [-200, 300],
      "webhookId": "ai-clothing-frontend-v3"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "feishu-trigger",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-feishu",
      "name": "Webhookè§¦å‘å™¨-é£ä¹¦",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [200, 300],
      "webhookId": "feishu-trigger-v4"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "field-taskId",
              "name": "taskId",
              "value": "={{ $json.taskId }}",
              "type": "string"
            },
            {
              "id": "field-userId",
              "name": "userId",
              "value": "={{ $json.userId }}",
              "type": "string"
            },
            {
              "id": "field-productImageUrl",
              "name": "productImageUrl",
              "value": "={{ $json.productImageUrl }}",
              "type": "string"
            },
            {
              "id": "field-sceneImageUrl",
              "name": "sceneImageUrl",
              "value": "={{ $json.sceneImageUrl }}",
              "type": "string"
            },
            {
              "id": "field-prompt",
              "name": "prompt",
              "value": "={{ $json.prompt }}",
              "type": "string"
            },
            {
              "id": "field-aiModel",
              "name": "aiModel",
              "value": "={{ $json.aiModel }}",
              "type": "string"
            },
            {
              "id": "field-aspectRatio",
              "name": "aspectRatio",
              "value": "={{ $json.aspectRatio }}",
              "type": "string"
            },
            {
              "id": "field-imageCount",
              "name": "imageCount",
              "value": "={{ $json.imageCount }}",
              "type": "number"
            },
            {
              "id": "field-quality",
              "name": "quality",
              "value": "={{ $json.quality }}",
              "type": "string"
            },
            {
              "id": "field-callbackUrl",
              "name": "callbackUrl",
              "value": "={{ $json.callbackUrl }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "parse-params",
      "name": "è§£æè¯·æ±‚å‚æ•°",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [0, 300]
    },
    {
      "parameters": {
        "resource": "auth",
        "operation": "auth:getAccessToken"
      },
      "id": "feishu-auth",
      "name": "é£ä¹¦é‰´æƒ",
      "type": "n8n-nodes-feishu-lite.feishuNode",
      "typeVersion": 1,
      "position": [400, 300],
      "credentials": {
        "feishuCredentialsApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Feishu Credentials account 3"
        }
      }
    },
    {
      "parameters": {
        "resource": "bitable",
        "operation": "bitable:table:record:get",
        "app_toke": "={{ $json.body.app_token }}",
        "table_id": "={{ $json.body.table_id }}",
        "record_id": "={{ $json.body.record_id }}"
      },
      "id": "get-feishu-data",
      "name": "è·å–é£ä¹¦æ•°æ®",
      "type": "n8n-nodes-feishu-lite.feishuNode",
      "typeVersion": 1,
      "position": [600, 300],
      "credentials": {
        "feishuCredentialsApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Feishu Credentials account 3"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "field-recordId",
              "name": "record_id",
              "value": "={{ $('Webhookè§¦å‘å™¨-é£ä¹¦').item.json.body.record_id }}",
              "type": "string"
            },
            {
              "id": "field-appToken",
              "name": "app_token",
              "value": "={{ $('Webhookè§¦å‘å™¨-é£ä¹¦').item.json.body.app_token }}",
              "type": "string"
            },
            {
              "id": "field-tableId",
              "name": "table_id",
              "value": "={{ $('Webhookè§¦å‘å™¨-é£ä¹¦').item.json.body.table_id }}",
              "type": "string"
            },
            {
              "id": "field-prompt-feishu",
              "name": "prompt",
              "value": "={{ $json.data.records[0].fields['æç¤ºè¯'][0].text }}",
              "type": "string"
            },
            {
              "id": "field-productImageUrl-feishu",
              "name": "productImageUrl",
              "value": "={{ $json.data.records[0].fields['å•†å“å›¾'][0].url }}",
              "type": "string"
            },
            {
              "id": "field-sceneImageUrl-feishu",
              "name": "sceneImageUrl",
              "value": "={{ $json.data.records[0].fields['åœºæ™¯å›¾'] && $json.data.records[0].fields['åœºæ™¯å›¾'][0].url || '' }}",
              "type": "string"
            },
            {
              "id": "field-aspectRatio-feishu",
              "name": "aspectRatio",
              "value": "={{ $json.data.records[0].fields['å°ºå¯¸æ¯”ä¾‹'] || '3:4' }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "extract-feishu-params",
      "name": "æå–é£ä¹¦å‚æ•°",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [800, 300]
    },
    {
      "parameters": {
        "resource": "bitable",
        "operation": "bitable:table:record:update",
        "app_toke": "={{ $('æå–é£ä¹¦å‚æ•°').item.json.app_token }}",
        "table_id": "={{ $('æå–é£ä¹¦å‚æ•°').item.json.table_id }}",
        "record_id": "={{ $('æå–é£ä¹¦å‚æ•°').item.json.record_id }}",
        "body": "={\n  \"fields\": {\n    \"çŠ¶æ€\": \"å¤„ç†ä¸­\"\n  }\n}"
      },
      "id": "update-feishu-processing",
      "name": "æ›´æ–°é£ä¹¦çŠ¶æ€-å¤„ç†ä¸­",
      "type": "n8n-nodes-feishu-lite.feishuNode",
      "typeVersion": 1,
      "position": [1000, 300],
      "credentials": {
        "feishuCredentialsApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Feishu Credentials account 3"
        }
      }
    },
    {
      "parameters": {
        "url": "={{ $json.productImageUrl }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{ $('é£ä¹¦é‰´æƒ').item.json.accessToken }}"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "id": "download-product-image",
      "name": "ä¸‹è½½å•†å“å›¾ç‰‡",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [1200, 300]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "leftValue": "={{ $json.sceneImageUrl }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "isNotEmpty"
              },
              "id": "check-scene-image"
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "check-scene-image",
      "name": "åˆ¤æ–­æ˜¯å¦æœ‰åœºæ™¯å›¾",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.1,
      "position": [1400, 300]
    },
    {
      "parameters": {
        "url": "={{ $json.sceneImageUrl }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{ $('é£ä¹¦é‰´æƒ').item.json.accessToken }}"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "data2"
            }
          }
        }
      },
      "id": "download-scene-image",
      "name": "ä¸‹è½½åœºæ™¯å›¾",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [1200, 150]
    },
    {
      "parameters": {
        "mode": "image",
        "userPrompt": "={{ $json.prompt }}æ³¨æ„ï¼šç¬¬ä¸€å¼ å›¾ç‰‡æ˜¯äº§å“å›¾ï¼Œç¬¬äºŒå¼ å›¾ç‰‡æ˜¯åœºæ™¯å›¾ã€‚è¯·ä½¿ç”¨ç¬¬ä¸€å¼ å›¾ç‰‡ï¼ˆäº§å“å›¾ï¼‰å’Œç¬¬äºŒå¼ å›¾ç‰‡ï¼ˆåœºæ™¯å›¾ï¼‰è¿›è¡Œç”Ÿæˆã€‚",
        "aspectRatio": "={{ $json.aspectRatio }}"
      },
      "id": "ai-generation",
      "name": "AIå›¾ç‰‡ç”Ÿæˆ",
      "type": "n8n-nodes-deerapi.deerApi",
      "typeVersion": 1,
      "position": [1600, 300],
      "credentials": {
        "deerApi": {
          "id": "YOUR_DEERAPI_CREDENTIAL_ID",
          "name": "DeerAPI account 2"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\nfor (let i = 0; i < items.length; i++) {\n  const item = items[i];\n  if (item.binary && item.binary.data) {\n    const buffer = await this.helpers.getBinaryDataBuffer(i, 'data');\n    item.json.real_size = buffer.length;\n    item.json.file_name = 'final_product.png';\n  }\n}\nreturn items;"
      },
      "id": "process-result",
      "name": "å¤„ç†ç”Ÿæˆç»“æœ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1800, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://open.feishu.cn/open-apis/drive/v1/medias/upload_all",
        "sendHeaders": true,
        "specifyHeaders": "json",
        "jsonHeaders": "={\n  \"Authorization\": \"Bearer {{ $('é£ä¹¦é‰´æƒ').item.json.accessToken }}\"\n}",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "parent_type",
              "value": "bitable_image"
            },
            {
              "name": "parent_node",
              "value": "={{ $('æå–é£ä¹¦å‚æ•°').item.json.app_token }}"
            },
            {
              "name": "file_name",
              "value": "={{ $json.file_name }}"
            },
            {
              "name": "size",
              "value": "={{ $json.real_size }}"
            },
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {}
      },
      "id": "upload-to-feishu",
      "name": "ä¸Šä¼ åˆ°é£ä¹¦",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [2000, 300]
    },
    {
      "parameters": {
        "resource": "bitable",
        "operation": "bitable:table:record:update",
        "app_toke": "={{ $('æå–é£ä¹¦å‚æ•°').item.json.app_token }}",
        "table_id": "={{ $('æå–é£ä¹¦å‚æ•°').item.json.table_id }}",
        "record_id": "={{ $('æå–é£ä¹¦å‚æ•°').item.json.record_id }}",
        "body": "={\n  \"fields\": {\n    \"ç”Ÿæˆç»“æœ\": [\n      {\n        \"file_token\": \"{{ $json.data.file_token }}\"\n      }\n    ],\n    \"çŠ¶æ€\": \"å·²å®Œæˆ\"\n  }\n}"
      },
      "id": "update-feishu-result",
      "name": "æ›´æ–°é£ä¹¦ç»“æœ",
      "type": "n8n-nodes-feishu-lite.feishuNode",
      "typeVersion": 1,
      "position": [2200, 300],
      "credentials": {
        "feishuCredentialsApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Feishu Credentials account 3"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"recordId\": \"{{ $('æå–é£ä¹¦å‚æ•°').item.json.record_id }}\",\n  \"message\": \"å›¾ç‰‡ç”ŸæˆæˆåŠŸ\"\n}",
        "options": {
          "responseCode": 200
        }
      },
      "id": "respond-feishu",
      "name": "è¿”å›æˆåŠŸå“åº”-é£ä¹¦",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [2400, 300]
    }
  ],
  "connections": {
    "Webhookè§¦å‘å™¨-å‰ç«¯": {
      "main": [
        [
          {
            "node": "è§£æè¯·æ±‚å‚æ•°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhookè§¦å‘å™¨-é£ä¹¦": {
      "main": [
        [
          {
            "node": "é£ä¹¦é‰´æƒ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é£ä¹¦é‰´æƒ": {
      "main": [
        [
          {
            "node": "è·å–é£ä¹¦æ•°æ®",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·å–é£ä¹¦æ•°æ®": {
      "main": [
        [
          {
            "node": "æå–é£ä¹¦å‚æ•°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æå–é£ä¹¦å‚æ•°": {
      "main": [
        [
          {
            "node": "æ›´æ–°é£ä¹¦çŠ¶æ€-å¤„ç†ä¸­",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ›´æ–°é£ä¹¦çŠ¶æ€-å¤„ç†ä¸­": {
      "main": [
        [
          {
            "node": "ä¸‹è½½å•†å“å›¾ç‰‡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸‹è½½å•†å“å›¾ç‰‡": {
      "main": [
        [
          {
            "node": "åˆ¤æ–­æ˜¯å¦æœ‰åœºæ™¯å›¾",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ¤æ–­æ˜¯å¦æœ‰åœºæ™¯å›¾": {
      "main": [
        [
          {
            "node": "ä¸‹è½½åœºæ™¯å›¾",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AIå›¾ç‰‡ç”Ÿæˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸‹è½½åœºæ™¯å›¾": {
      "main": [
        [
          {
            "node": "AIå›¾ç‰‡ç”Ÿæˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AIå›¾ç‰‡ç”Ÿæˆ": {
      "main": [
        [
          {
            "node": "å¤„ç†ç”Ÿæˆç»“æœ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å¤„ç†ç”Ÿæˆç»“æœ": {
      "main": [
        [
          {
            "node": "ä¸Šä¼ åˆ°é£ä¹¦",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸Šä¼ åˆ°é£ä¹¦": {
      "main": [
        [
          {
            "node": "æ›´æ–°é£ä¹¦ç»“æœ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ›´æ–°é£ä¹¦ç»“æœ": {
      "main": [
        [
          {
            "node": "è¿”å›æˆåŠŸå“åº”-é£ä¹¦",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "id": "ai-clothing-platform-dual-track",
  "tags": []
}
```

### 8.2 éœ€è¦æ›¿æ¢çš„å‡­è¯ID

åœ¨å¯¼å…¥å·¥ä½œæµåï¼Œéœ€è¦æ›¿æ¢ä»¥ä¸‹å‡­è¯IDï¼š

1. `YOUR_CREDENTIAL_ID` - æ›¿æ¢ä¸ºå®é™…çš„é£ä¹¦å‡­è¯ID
2. `YOUR_DEERAPI_CREDENTIAL_ID` - æ›¿æ¢ä¸ºå®é™…çš„DeerAPIå‡­è¯ID

---

## 9. å¿«é€Ÿé…ç½®æ£€æŸ¥æ¸…å•

### 9.1 é£ä¹¦è¡¨æ ¼é…ç½®

- [ ] 11ä¸ªå¿…éœ€å­—æ®µå·²åˆ›å»º
- [ ] å­—æ®µåç§°å®Œå…¨åŒ¹é…ï¼ˆæ³¨æ„ä¸­æ–‡å¼•å·ï¼‰
- [ ] "æ•°æ®æ¥æº"å­—æ®µé»˜è®¤å€¼ä¸º"ğŸŒ å‰ç«¯ç”¨æˆ·"
- [ ] "åŒæ­¥çŠ¶æ€"å­—æ®µé»˜è®¤å€¼ä¸º"âœ… å·²åŒæ­¥"
- [ ] é£ä¹¦è‡ªåŠ¨åŒ–å·²åˆ›å»ºå¹¶å¯ç”¨
- [ ] Webhook URLå·²é…ç½®åˆ°é£ä¹¦è‡ªåŠ¨åŒ–

### 9.2 N8Né…ç½®

- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®ï¼ˆFEISHU_APP_TOKEN, FEISHU_TABLE_IDï¼‰
- [ ] 3ä¸ªå‡­è¯å·²åˆ›å»ºï¼ˆé£ä¹¦ã€DeerAPIã€Header Authï¼‰
- [ ] å·¥ä½œæµå·²å¯¼å…¥
- [ ] ä¸¤ä¸ªWebhookå·²æ¿€æ´»
- [ ] å‡­è¯å·²å…³è”åˆ°èŠ‚ç‚¹

### 9.3 å‰ç«¯é…ç½®

- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] æ•°æ®åº“å·²è¿æ¥
- [ ] åº”ç”¨å·²éƒ¨ç½²åˆ°Vercel

---

## 10. æ€»ç»“

è¿™ä¸ªé…ç½®æŒ‡å—æä¾›äº†å®Œæ•´çš„ã€ç»è¿‡åå‘éªŒè¯çš„æ–‡æ¡£ï¼Œç¡®ä¿ï¼š

1. **ä¸‰ç«¯è”åŠ¨ä¸è„±èŠ‚**ï¼šå‰ç«¯ã€N8Nã€é£ä¹¦å®Œå…¨æ‰“é€š
2. **å­—æ®µæ˜ å°„æ­£ç¡®**ï¼šæ‰€æœ‰å­—æ®µåç§°å’Œç±»å‹éƒ½ç»è¿‡éªŒè¯
3. **æ•°æ®æµå®Œæ•´**ï¼šä»å‰ç«¯åˆ°é£ä¹¦åˆ°N8Nå†å›å‰ç«¯çš„å®Œæ•´é—­ç¯
4. **é”™è¯¯å¤„ç†å®Œå–„**ï¼šåŒ…å«é™çº§ç­–ç•¥å’Œé‡è¯•æœºåˆ¶

æŒ‰ç…§è¿™ä¸ªæŒ‡å—é…ç½®ï¼Œå¯ä»¥é¿å…å¤§éƒ¨åˆ†è¯•é”™ï¼Œå¿«é€Ÿæ­å»ºå®Œæ•´çš„åŒè½¨å·¥ä½œæµç³»ç»Ÿã€‚
