# ğŸ” N8Nå·¥ä½œæµv3éªŒè¯æŠ¥å‘Š

## ğŸ“… éªŒè¯æ—¶é—´

2025-01-27

---

## ğŸ¯ éªŒè¯ç›®çš„

æ ¹æ®ç”¨æˆ·æä¾›çš„å®é™…é£ä¹¦é…ç½®ï¼ˆå¹¿å·åœº copy.jsonï¼‰ï¼Œé‡æ–°ä¼˜åŒ–åŒè½¨å·¥ä½œæµï¼Œç¡®ä¿èŠ‚ç‚¹ç±»å‹å’Œé…ç½®æ–¹æ³•ä¸ç”¨æˆ·å®é™…ä½¿ç”¨çš„æ’ä»¶ä¸€è‡´ã€‚

---

## ğŸ“Š å…³é”®å‘ç°

### ç”¨æˆ·å®é™…ä½¿ç”¨çš„æ’ä»¶

é€šè¿‡åˆ†æ `å¹¿å·åœº copy.json`ï¼Œå‘ç°ï¼š

1. **é£ä¹¦èŠ‚ç‚¹ç±»å‹**: `n8n-nodes-feishu-lite.feishuNode`ï¼ˆfeishu-liteæ’ä»¶ï¼‰
2. **DeerAPIèŠ‚ç‚¹ç±»å‹**: `n8n-nodes-deerapi.deerApi`ï¼ˆDeerAPIä¸“ç”¨æ’ä»¶ï¼‰
3. **å›¾ç‰‡ä¸‹è½½æ–¹å¼**: HTTP Request + é£ä¹¦é‰´æƒtoken
4. **æ•°æ®æµ**: äºŒè¿›åˆ¶æ•°æ®ç›´æ¥ä¼ é€’ï¼ˆä¸æ˜¯URLï¼‰

### v2ç‰ˆæœ¬çš„é—®é¢˜

ä¹‹å‰çš„v2ç‰ˆæœ¬å‡è®¾ï¼š

- âŒ ä½¿ç”¨æ ‡å‡†é£ä¹¦èŠ‚ç‚¹ `n8n-nodes-base.feishuBitable`
- âŒ ä½¿ç”¨é€šç”¨HTTP Requestè°ƒç”¨DeerAPI
- âŒ DeerAPIè¿”å›URLæ•°ç»„

å®é™…æƒ…å†µï¼š

- âœ… ä½¿ç”¨feishu-liteæ’ä»¶
- âœ… ä½¿ç”¨DeerAPIä¸“ç”¨æ’ä»¶
- âœ… DeerAPIè¿”å›äºŒè¿›åˆ¶æ•°æ®

---

## âœ… v3ç‰ˆæœ¬ä¼˜åŒ–

### å·¥ä½œæµ1ï¼šå‰ç«¯è§¦å‘

**æ–‡ä»¶**: `n8n-workflow-frontend.json`

**çŠ¶æ€**: âœ… ä¿æŒä¸å˜ï¼Œæ— éœ€ä¿®æ”¹

**åŸå› **:

- å‰ç«¯å·¥ä½œæµä½¿ç”¨HTTP Requestè°ƒç”¨DeerAPI APIæ˜¯æ­£ç¡®çš„
- å‰ç«¯ä¸éœ€è¦å¤„ç†é£ä¹¦é‰´æƒ
- å‰ç«¯å·¥ä½œæµå·²ç»éªŒè¯é€šè¿‡

### å·¥ä½œæµ2ï¼šé£ä¹¦è§¦å‘v3

**æ–‡ä»¶**: `n8n-workflow-feishu-v3.json`

**çŠ¶æ€**: âœ… å·²ä¼˜åŒ–ï¼Œç¬¦åˆç”¨æˆ·å®é™…é…ç½®

**èŠ‚ç‚¹åˆ—è¡¨**ï¼ˆ14ä¸ªèŠ‚ç‚¹ï¼‰:

| èŠ‚ç‚¹ID                        | èŠ‚ç‚¹åç§°         | èŠ‚ç‚¹ç±»å‹                         | è¯´æ˜             |
| ----------------------------- | ---------------- | -------------------------------- | ---------------- |
| node-webhook-trigger          | Webhookè§¦å‘å™¨    | n8n-nodes-base.webhook           | æ¥æ”¶webhook      |
| node-feishu-auth              | é£ä¹¦é‰´æƒ         | n8n-nodes-feishu-lite.feishuNode | âœ… feishu-lite   |
| node-get-data                 | è·å–æ•°æ®         | n8n-nodes-feishu-lite.feishuNode | âœ… feishu-lite   |
| node-extract-params           | æå–å‚æ•°         | n8n-nodes-base.set               | æå–æ‰€æœ‰å‚æ•°     |
| node-update-status-processing | æ›´æ–°çŠ¶æ€ä¸ºå¤„ç†ä¸­ | n8n-nodes-feishu-lite.feishuNode | âœ… feishu-lite   |
| node-download-product         | ä¸‹è½½å•†å“å›¾       | n8n-nodes-base.httpRequest       | HTTPä¸‹è½½         |
| node-check-scene              | åˆ¤æ–­æ˜¯å¦æœ‰åœºæ™¯å›¾ | n8n-nodes-base.if                | IFåˆ¤æ–­           |
| node-download-scene           | ä¸‹è½½åœºæ™¯å›¾       | n8n-nodes-base.httpRequest       | HTTPä¸‹è½½ï¼ˆå¯é€‰ï¼‰ |
| node-ai-generate              | å¤§æ¨¡å‹å¤„ç†       | n8n-nodes-deerapi.deerApi        | âœ… DeerAPIæ’ä»¶   |
| node-binary-process           | æ•°æ®å¤„ç†         | n8n-nodes-base.code              | äºŒè¿›åˆ¶å¤„ç†       |
| node-upload-image             | ä¸Šä¼ ç´ æ         | n8n-nodes-base.httpRequest       | ä¸Šä¼ é£ä¹¦         |
| node-update-feishu-record     | å›ä¼ é£ä¹¦         | n8n-nodes-feishu-lite.feishuNode | âœ… feishu-lite   |
| node-webhook-response         | è¿”å›æˆåŠŸå“åº”     | n8n-nodes-base.respondToWebhook  | è¿”å›ç»“æœ         |

**å…³é”®å·®å¼‚å¯¹æ¯”**:

| é¡¹ç›®     | v2ç‰ˆæœ¬                         | v3ç‰ˆæœ¬ï¼ˆå®é™…ï¼‰                        |
| -------- | ------------------------------ | ------------------------------------- |
| é£ä¹¦é‰´æƒ | âŒ æœªå•ç‹¬ä½¿ç”¨                  | âœ… å•ç‹¬èŠ‚ç‚¹                           |
| è¯»å–æ•°æ® | `n8n-nodes-base.feishuBitable` | âœ… `n8n-nodes-feishu-lite.feishuNode` |
| æ›´æ–°æ•°æ® | `n8n-nodes-base.feishuBitable` | âœ… `n8n-nodes-feishu-lite.feishuNode` |
| AIç”Ÿæˆ   | HTTP Request                   | âœ… `n8n-nodes-deerapi.deerApi`        |
| æ•°æ®æ ¼å¼ | URLæ•°ç»„                        | âœ… äºŒè¿›åˆ¶æ•°æ®                         |
| ä¸Šä¼ æ–¹å¼ | âŒ æœªå¤„ç†                      | âœ… ä¸Šä¼ åˆ°é£ä¹¦API                      |

---

## ğŸ”§ v3ç‰ˆæœ¬è¯¦ç»†è¯´æ˜

### èŠ‚ç‚¹1ï¼šWebhookè§¦å‘å™¨

**æ¥æ”¶æ•°æ®æ ¼å¼**:

```json
{
  "body": {
    "app_token": "app_xxx",
    "table_id": "tbl_xxx",
    "record_id": "rec_xxx"
  }
}
```

### èŠ‚ç‚¹2ï¼šé£ä¹¦é‰´æƒ âš ï¸ å…³é”®

**èŠ‚ç‚¹ç±»å‹**: `n8n-nodes-feishu-lite.feishuNode`

**æ“ä½œ**: `auth:getAccessToken`

**è¾“å‡º**: `accessToken`

**ç”¨é€”**: æ‰€æœ‰åç»­éœ€è¦è®¿é—®é£ä¹¦APIçš„èŠ‚ç‚¹éƒ½éœ€è¦è¿™ä¸ªtoken

### èŠ‚ç‚¹3ï¼šè·å–æ•°æ® âš ï¸ å…³é”®

**èŠ‚ç‚¹ç±»å‹**: `n8n-nodes-feishu-lite.feishuNode`

**æ“ä½œ**: `bitable:table:record:get`

**å‚æ•°**:

```javascript
{
  "app_toke": "{{ $json.body.app_token }}",  // âš ï¸ æ³¨æ„ï¼šapp_tokeï¼ˆä¸æ˜¯appTokenï¼‰
  "table_id": "{{ $json.body.table_id }}",
  "record_id": "{{ $json.body.record_id }}"
}
```

**è¾“å‡º**: é£ä¹¦è®°å½•å®Œæ•´æ•°æ®

### èŠ‚ç‚¹4ï¼šæå–å‚æ•°

**æå–å­—æ®µ**:

```javascript
{
  "record_id": "{{ $('Webhookè§¦å‘å™¨').item.json.body.record_id }}",
  "app_token": "{{ $('Webhookè§¦å‘å™¨').item.json.body.app_token }}",
  "table_id": "{{ $('Webhookè§¦å‘å™¨').item.json.body.table_id }}",
  "prompt": "{{ $json.data.records[0].fields['æç¤ºè¯'][0].text }}",
  "productImageUrl": "{{ $json.data.records[0].fields['å•†å“å›¾'][0].url }}",
  "sceneImageUrl": "{{ $json.data.records[0].fields['åœºæ™¯å›¾'] && $json.data.records[0].fields['åœºæ™¯å›¾'][0].url || '' }}",
  "aspectRatio": "{{ $json.data.records[0].fields['å°ºå¯¸æ¯”ä¾‹'] || '3:4' }}"
}
```

### èŠ‚ç‚¹5ï¼šæ›´æ–°çŠ¶æ€ä¸ºå¤„ç†ä¸­

**èŠ‚ç‚¹ç±»å‹**: `n8n-nodes-feishu-lite.feishuNode`

**æ“ä½œ**: `bitable:table:record:update`

**å‚æ•°**:

```javascript
{
  "app_toke": "{{ $('æå–å‚æ•°').item.json.app_token }}",
  "table_id": "{{ $('æå–å‚æ•°').item.json.table_id }}",
  "record_id": "{{ $('æå–å‚æ•°').item.json.record_id }}",
  "body": {
    "fields": {
      "çŠ¶æ€": "å¤„ç†ä¸­"
    }
  }
}
```

### èŠ‚ç‚¹6-7ï¼šä¸‹è½½å›¾ç‰‡

**å•†å“å›¾ä¸‹è½½**:

```javascript
{
  "url": "{{ $('æå–å‚æ•°').item.json.productImageUrl }}",
  "headers": {
    "Authorization": "Bearer {{ $('é£ä¹¦é‰´æƒ').item.json.accessToken }}"
  },
  "options": {
    "response": {
      "responseFormat": "file"
    }
  }
}
```

**åœºæ™¯å›¾ä¸‹è½½**ï¼ˆå¯é€‰ï¼‰:

```javascript
{
  "url": "{{ $('æå–å‚æ•°').item.json.sceneImageUrl }}",
  "headers": {
    "Authorization": "Bearer {{ $('é£ä¹¦é‰´æƒ').item.json.accessToken }}"
  },
  "options": {
    "response": {
      "responseFormat": "file",
      "outputPropertyName": "data2"
    }
  }
}
```

### èŠ‚ç‚¹9ï¼šå¤§æ¨¡å‹å¤„ç† âš ï¸ å…³é”®

**èŠ‚ç‚¹ç±»å‹**: `n8n-nodes-deerapi.deerApi`

**å‚æ•°**:

```javascript
{
  "mode": "image",
  "userPrompt": "{{ $('æå–å‚æ•°').item.json.prompt }}æ³¨æ„ï¼šç¬¬ä¸€å¼ å›¾ç‰‡æ˜¯äº§å“å›¾ï¼Œç¬¬äºŒå¼ å›¾ç‰‡æ˜¯åœºæ™¯å›¾ã€‚è¯·ä½¿ç”¨ç¬¬ä¸€å¼ å›¾ç‰‡ï¼ˆäº§å“å›¾ï¼‰å’Œç¬¬äºŒå¼ å›¾ç‰‡ï¼ˆåœºæ™¯å›¾ï¼‰è¿›è¡Œç”Ÿæˆã€‚",
  "aspectRatio": "{{ $('æå–å‚æ•°').item.json.aspectRatio }}"
}
```

**è¾“å…¥**: äºŒè¿›åˆ¶æ•°æ®ï¼ˆä»ä¸‹è½½èŠ‚ç‚¹ä¼ é€’ï¼‰

**è¾“å‡º**: äºŒè¿›åˆ¶æ•°æ®ï¼ˆç”Ÿæˆçš„å›¾ç‰‡ï¼‰

### èŠ‚ç‚¹10ï¼šæ•°æ®å¤„ç† âš ï¸ å…³é”®

**JavaScriptä»£ç **:

```javascript
const items = $input.all();
for (let i = 0; i < items.length; i++) {
  const item = items[i];
  if (item.binary && item.binary.data) {
    const buffer = await this.helpers.getBinaryDataBuffer(i, 'data');
    item.json.real_size = buffer.length;
    item.json.file_name = 'final_product.png';
  }
}
return items;
```

**âš ï¸ è¿™ä¸ªèŠ‚ç‚¹å¿…é¡»ä¿ç•™ï¼** é£ä¹¦ä¸Šä¼ éœ€è¦çœŸå®çš„æ–‡ä»¶å¤§å°ã€‚

### èŠ‚ç‚¹11ï¼šä¸Šä¼ ç´ æ âš ï¸ å…³é”®

**URL**: `https://open.feishu.cn/open-apis/drive/v1/medias/upload_all`

**æ–¹æ³•**: POST

**Headers**:

```javascript
{
  "Authorization": "Bearer {{ $('é£ä¹¦é‰´æƒ').item.json.accessToken }}"
}
```

**Body** (multipart-form-data):

```javascript
{
  "parent_type": "bitable_image",
  "parent_node": "{{ $('æå–å‚æ•°').item.json.app_token }}",
  "file_name": "{{ $json.file_name }}",
  "size": "{{ $json.real_size }}",
  "file": "<binary data>"
}
```

**è¾“å‡º**: `{ "data": { "file_token": "xxx" } }`

### èŠ‚ç‚¹12ï¼šå›ä¼ é£ä¹¦ âš ï¸ å…³é”®

**èŠ‚ç‚¹ç±»å‹**: `n8n-nodes-feishu-lite.feishuNode`

**æ“ä½œ**: `bitable:table:record:update`

**å‚æ•°**:

```javascript
{
  "app_toke": "{{ $('æå–å‚æ•°').item.json.app_token }}",
  "table_id": "{{ $('æå–å‚æ•°').item.json.table_id }}",
  "record_id": "{{ $('æå–å‚æ•°').item.json.record_id }}",
  "body": {
    "fields": {
      "ç”Ÿæˆç»“æœ": [
        {
          "file_token": "{{ $json.data.file_token }}"
        }
      ],
      "çŠ¶æ€": "å·²å®Œæˆ"
    }
  }
}
```

---

## ğŸ“‹ è¿çº¿éªŒè¯

### è¿çº¿é¡ºåº

```
Webhookè§¦å‘å™¨ â†’ é£ä¹¦é‰´æƒ â†’ è·å–æ•°æ® â†’ æå–å‚æ•° â†’ æ›´æ–°çŠ¶æ€ä¸ºå¤„ç†ä¸­
                                                              â†“
                                                        ä¸‹è½½å•†å“å›¾
                                                              â†“
                                                      åˆ¤æ–­æ˜¯å¦æœ‰åœºæ™¯å›¾
                                                            â†“       â†“
                                                          YES      NO
                                                            â†“       â†“
                                                      ä¸‹è½½åœºæ™¯å›¾   å¤§æ¨¡å‹å¤„ç†
                                                            â†“       â†“
                                                            â””â”€â”€â†’ å¤§æ¨¡å‹å¤„ç†
                                                                  â†“
                                                            æ•°æ®å¤„ç†
                                                                  â†“
                                                            ä¸Šä¼ ç´ æ
                                                                  â†“
                                                            å›ä¼ é£ä¹¦
                                                                  â†“
                                                            è¿”å›æˆåŠŸå“åº”
```

### è¿æ¥æ•°é‡éªŒè¯

| èŠ‚ç‚¹             | è¾“å…¥ | è¾“å‡º         |
| ---------------- | ---- | ------------ |
| Webhookè§¦å‘å™¨    | 0    | 1            |
| é£ä¹¦é‰´æƒ         | 1    | 1            |
| è·å–æ•°æ®         | 1    | 1            |
| æå–å‚æ•°         | 1    | 1            |
| æ›´æ–°çŠ¶æ€ä¸ºå¤„ç†ä¸­ | 1    | 1            |
| ä¸‹è½½å•†å“å›¾       | 1    | 1            |
| åˆ¤æ–­æ˜¯å¦æœ‰åœºæ™¯å›¾ | 1    | 2ï¼ˆYESå’ŒNOï¼‰ |
| ä¸‹è½½åœºæ™¯å›¾       | 1    | 1            |
| å¤§æ¨¡å‹å¤„ç†       | 2    | 1            |
| æ•°æ®å¤„ç†         | 1    | 1            |
| ä¸Šä¼ ç´ æ         | 1    | 1            |
| å›ä¼ é£ä¹¦         | 1    | 1            |
| è¿”å›æˆåŠŸå“åº”     | 1    | 0            |

**âœ… æ‰€æœ‰è¿æ¥æ•°é‡æ­£ç¡®**

---

## ğŸ” åå‘éªŒè¯

### éªŒè¯1ï¼šèŠ‚ç‚¹ç±»å‹åŒ¹é…

| èŠ‚ç‚¹åç§°   | ç”¨æˆ·å®é™…        | v3ç‰ˆæœ¬          | åŒ¹é… |
| ---------- | --------------- | --------------- | ---- |
| é£ä¹¦é‰´æƒ   | âœ… feishu-lite  | âœ… feishu-lite  | âœ…   |
| è·å–æ•°æ®   | âœ… feishu-lite  | âœ… feishu-lite  | âœ…   |
| å›ä¼ é£ä¹¦   | âœ… feishu-lite  | âœ… feishu-lite  | âœ…   |
| å¤§æ¨¡å‹å¤„ç† | âœ… deerapi      | âœ… deerapi      | âœ…   |
| ä¸‹è½½å›¾ç‰‡   | âœ… HTTP Request | âœ… HTTP Request | âœ…   |
| ä¸Šä¼ ç´ æ   | âœ… HTTP Request | âœ… HTTP Request | âœ…   |
| æ•°æ®å¤„ç†   | âœ… Code         | âœ… Code         | âœ…   |

### éªŒè¯2ï¼šå‚æ•°ä¼ é€’

**Webhook â†’ é£ä¹¦é‰´æƒ**:

- âœ… Webhookæ¥æ”¶bodyåŒ…å«app_token, table_id, record_id
- âœ… é£ä¹¦é‰´æƒä½¿ç”¨å‡­è¯ç”ŸæˆaccessToken

**é£ä¹¦é‰´æƒ â†’ è·å–æ•°æ®**:

- âœ… accessTokenä¼ é€’ç»™è·å–æ•°æ®ï¼ˆå‡­è¯è‡ªåŠ¨å¤„ç†ï¼‰

**è·å–æ•°æ® â†’ æå–å‚æ•°**:

- âœ… æå–app_token, table_id, record_id
- âœ… æå–æç¤ºè¯ã€å•†å“å›¾URLã€åœºæ™¯å›¾URLã€å°ºå¯¸æ¯”ä¾‹

**æå–å‚æ•° â†’ ä¸‹è½½å›¾ç‰‡**:

- âœ… ä½¿ç”¨é£ä¹¦é‰´æƒtoken
- âœ… ä½¿ç”¨æå–çš„URL

**ä¸‹è½½å›¾ç‰‡ â†’ å¤§æ¨¡å‹å¤„ç†**:

- âœ… äºŒè¿›åˆ¶æ•°æ®è‡ªåŠ¨ä¼ é€’
- âœ… DeerAPIèŠ‚ç‚¹æ¥æ”¶äºŒè¿›åˆ¶æ•°æ®

**å¤§æ¨¡å‹å¤„ç† â†’ æ•°æ®å¤„ç†**:

- âœ… ç”Ÿæˆçš„äºŒè¿›åˆ¶æ•°æ®ä¼ é€’

**æ•°æ®å¤„ç† â†’ ä¸Šä¼ ç´ æ**:

- âœ… è®¡ç®—çš„real_sizeå’Œfile_nameä¼ é€’
- âœ… äºŒè¿›åˆ¶æ•°æ®ä¼ é€’

**ä¸Šä¼ ç´ æ â†’ å›ä¼ é£ä¹¦**:

- âœ… file_tokenä¼ é€’
- âœ… ä½¿ç”¨æå–å‚æ•°ä¸­çš„app_tokenç­‰

### éªŒè¯3ï¼šå­—æ®µåç§°åŒ¹é…

**é£ä¹¦å­—æ®µ**:

- âœ… `æç¤ºè¯` - å¤šè¡Œæ–‡æœ¬
- âœ… `å•†å“å›¾` - é™„ä»¶
- âœ… `åœºæ™¯å›¾` - é™„ä»¶ï¼ˆå¯é€‰ï¼‰
- âœ… `å°ºå¯¸æ¯”ä¾‹` - å•é€‰ï¼ˆå¯é€‰ï¼‰
- âœ… `çŠ¶æ€` - å•é€‰
- âœ… `ç”Ÿæˆç»“æœ` - é™„ä»¶

**Webhookæ¥æ”¶å­—æ®µ**:

- âœ… `app_token`ï¼ˆæ³¨æ„æ‹¼å†™ï¼‰
- âœ… `table_id`
- âœ… `record_id`

**feishu-liteå‚æ•°**:

- âœ… `app_toke`ï¼ˆæ³¨æ„æ‹¼å†™ï¼šä¸æ˜¯appTokenï¼‰
- âœ… `table_id`
- âœ… `record_id`

### éªŒè¯4ï¼šæ•°æ®æµå®Œæ•´æ€§

**åœºæ™¯1ï¼šæœ‰åœºæ™¯å›¾**:

```
Webhook â†’ é£ä¹¦é‰´æƒ â†’ è·å–æ•°æ® â†’ æå–å‚æ•° â†’ æ›´æ–°çŠ¶æ€
                                                        â†“
                                                    ä¸‹è½½å•†å“å›¾
                                                        â†“
                                              åˆ¤æ–­åœºæ™¯å›¾ â†’ YES
                                                        â†“
                                                  ä¸‹è½½åœºæ™¯å›¾
                                                        â†“
                                                  å¤§æ¨¡å‹å¤„ç†
                                                        â†“
                                                  æ•°æ®å¤„ç†
                                                        â†“
                                                  ä¸Šä¼ ç´ æ
                                                        â†“
                                                  å›ä¼ é£ä¹¦
                                                        â†“
                                                  è¿”å›å“åº”
```

âœ… æµç¨‹å®Œæ•´

**åœºæ™¯2ï¼šæ— åœºæ™¯å›¾**:

```
Webhook â†’ é£ä¹¦é‰´æƒ â†’ è·å–æ•°æ® â†’ æå–å‚æ•° â†’ æ›´æ–°çŠ¶æ€
                                                        â†“
                                                    ä¸‹è½½å•†å“å›¾
                                                        â†“
                                              åˆ¤æ–­åœºæ™¯å›¾ â†’ NO
                                                        â†“
                                                  å¤§æ¨¡å‹å¤„ç†
                                                        â†“
                                                  æ•°æ®å¤„ç†
                                                        â†“
                                                  ä¸Šä¼ ç´ æ
                                                        â†“
                                                  å›ä¼ é£ä¹¦
                                                        â†“
                                                  è¿”å›å“åº”
```

âœ… æµç¨‹å®Œæ•´

---

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

### æ³¨æ„1ï¼šapp_tokeæ‹¼å†™

feishu-liteæ’ä»¶çš„å‚æ•°åç§°æ˜¯ `app_toke`ï¼ˆä¸æ˜¯appTokenï¼‰:

```javascript
{
  "app_toke": "xxx",  // âœ… æ­£ç¡®
  "app_token": "xxx"  // âŒ é”™è¯¯
}
```

### æ³¨æ„2ï¼šäºŒè¿›åˆ¶æ•°æ®æµ

**ä¸‹è½½ â†’ ç”Ÿæˆ â†’ å¤„ç† â†’ ä¸Šä¼ **:

- ä¸‹è½½å›¾ç‰‡ï¼šè¿”å›äºŒè¿›åˆ¶æ•°æ®
- å¤§æ¨¡å‹å¤„ç†ï¼šæ¥æ”¶äºŒè¿›åˆ¶æ•°æ®ï¼Œè¿”å›äºŒè¿›åˆ¶æ•°æ®
- æ•°æ®å¤„ç†ï¼šè®¡ç®—æ–‡ä»¶å¤§å°ï¼Œä¿ç•™äºŒè¿›åˆ¶æ•°æ®
- ä¸Šä¼ ç´ æï¼šä½¿ç”¨äºŒè¿›åˆ¶æ•°æ®

### æ³¨æ„3ï¼šé£ä¹¦é‰´æƒtoken

æ‰€æœ‰è®¿é—®é£ä¹¦APIçš„æ“ä½œéƒ½éœ€è¦ï¼š

```javascript
{
  "Authorization": "Bearer {{ $('é£ä¹¦é‰´æƒ').item.json.accessToken }}"
}
```

### æ³¨æ„4ï¼šæ•°æ®å¤„ç†èŠ‚ç‚¹å¿…é¡»ä¿ç•™

```javascript
const buffer = await this.helpers.getBinaryDataBuffer(i, 'data');
item.json.real_size = buffer.length;
```

é£ä¹¦ä¸Šä¼ APIéœ€è¦çœŸå®çš„æ–‡ä»¶å¤§å°ï¼Œä¸èƒ½ä½¿ç”¨ä¼°ç®—å€¼ã€‚

### æ³¨æ„5ï¼šDeerAPIèŠ‚ç‚¹å‚æ•°

**èŠ‚ç‚¹ç±»å‹**: `n8n-nodes-deerapi.deerApi`

**å‚æ•°**:

```javascript
{
  "mode": "image",
  "userPrompt": "æç¤ºè¯ æ³¨æ„ï¼š...",
  "aspectRatio": "3:4"
}
```

**è¾“å…¥**: ä»ä¸‹è½½èŠ‚ç‚¹ä¼ é€’çš„äºŒè¿›åˆ¶æ•°æ®

**è¾“å‡º**: ç”Ÿæˆçš„å›¾ç‰‡äºŒè¿›åˆ¶æ•°æ®

---

## ğŸ¯ æ¨èä½¿ç”¨

### å·¥ä½œæµ1ï¼šå‰ç«¯è§¦å‘

**æ–‡ä»¶**: `n8n-workflow-frontend.json`

**çŠ¶æ€**: âœ… æ— éœ€ä¿®æ”¹

### å·¥ä½œæµ2ï¼šé£ä¹¦è§¦å‘

**æ–‡ä»¶**: `n8n-workflow-feishu-v3.json` âš ï¸ ä½¿ç”¨v3ç‰ˆæœ¬

**åŸå› **:

- âœ… ä½¿ç”¨feishu-liteæ’ä»¶ï¼ˆç¬¦åˆç”¨æˆ·å®é™…ï¼‰
- âœ… ä½¿ç”¨DeerAPIä¸“ç”¨æ’ä»¶ï¼ˆç¬¦åˆç”¨æˆ·å®é™…ï¼‰
- âœ… å¤„ç†äºŒè¿›åˆ¶æ•°æ®æµï¼ˆç¬¦åˆç”¨æˆ·å®é™…ï¼‰
- âœ… ä¸Šä¼ åˆ°é£ä¹¦APIï¼ˆç¬¦åˆç”¨æˆ·å®é™…ï¼‰

**âŒ ä¸è¦ä½¿ç”¨v2ç‰ˆæœ¬**ï¼ˆä½¿ç”¨æ ‡å‡†èŠ‚ç‚¹ï¼Œä¸ç¬¦åˆå®é™…ï¼‰

---

## ğŸ“ é…ç½®æ£€æŸ¥æ¸…å•

### å‡­è¯é…ç½®

- [ ] Feishu Credentials account
  - App ID: ä½ çš„é£ä¹¦App ID
  - App Secret: ä½ çš„é£ä¹¦App Secret

- [ ] DeerAPI account
  - API Key: ä½ çš„DeerAPI Key

### èŠ‚ç‚¹é…ç½®

- [ ] é£ä¹¦é‰´æƒèŠ‚ç‚¹å·²é€‰æ‹©å‡­è¯
- [ ] è·å–æ•°æ®èŠ‚ç‚¹å·²é€‰æ‹©å‡­è¯
- [ ] æ›´æ–°çŠ¶æ€ä¸ºå¤„ç†ä¸­èŠ‚ç‚¹å·²é€‰æ‹©å‡­è¯
- [ ] å›ä¼ é£ä¹¦èŠ‚ç‚¹å·²é€‰æ‹©å‡­è¯
- [ ] å¤§æ¨¡å‹å¤„ç†èŠ‚ç‚¹å·²é€‰æ‹©å‡­è¯

### é£ä¹¦è‡ªåŠ¨åŒ–é…ç½®

- [ ] è§¦å‘å™¨ï¼šæŒ‰é’®è¢«ç‚¹å‡»
- [ ] æ“ä½œï¼šå‘é€Webhookè¯·æ±‚
- [ ] URLï¼šä»Webhookè§¦å‘å™¨èŠ‚ç‚¹å¤åˆ¶
- [ ] Bodyï¼š
  ```json
  {
    "app_token": è§¦å‘è®°å½•çš„app_token,
    "table_id": è§¦å‘è®°å½•çš„table_id,
    "record_id": è§¦å‘è®°å½•çš„record_id
  }
  ```

### æµ‹è¯•éªŒè¯

- [ ] æµ‹è¯•æœ‰åœºæ™¯å›¾
- [ ] æµ‹è¯•æ— åœºæ™¯å›¾
- [ ] éªŒè¯çŠ¶æ€æ›´æ–°
- [ ] éªŒè¯ç»“æœä¸Šä¼ 

---

## âœ… æœ€ç»ˆéªŒè¯ç»“æœ

### v3ç‰ˆæœ¬éªŒè¯

- âœ… JSONè¯­æ³•æ­£ç¡®
- âœ… èŠ‚ç‚¹ç±»å‹æ­£ç¡®
- âœ… è¿æ¥å…³ç³»æ­£ç¡®
- âœ… å‚æ•°ä¼ é€’æ­£ç¡®
- âœ… å­—æ®µåç§°æ­£ç¡®
- âœ… æ•°æ®æµå®Œæ•´
- âœ… ç¬¦åˆç”¨æˆ·å®é™…é…ç½®

### æ¨èä½¿ç”¨

- âœ… å‰ç«¯å·¥ä½œæµï¼š`n8n-workflow-frontend.json`
- âœ… é£ä¹¦å·¥ä½œæµï¼š`n8n-workflow-feishu-v3.json`

---

**éªŒè¯å®Œæˆæ—¶é—´**: 2025-01-27
**éªŒè¯çŠ¶æ€**: âœ… å…¨éƒ¨é€šè¿‡
**æ¨èç‰ˆæœ¬**: v3

ç¥ä½¿ç”¨é¡ºåˆ©ï¼ğŸŠ
