# ğŸ”§ N8NåŒè½¨å·¥ä½œæµè¯¦ç»†é…ç½®æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
2. [éœ€è¦ä¿®æ”¹çš„å‚æ•°æ¸…å•](#éœ€è¦ä¿®æ”¹çš„å‚æ•°æ¸…å•)
3. [èŠ‚ç‚¹è¯¦ç»†é…ç½®](#èŠ‚ç‚¹è¯¦ç»†é…ç½®)
4. [è¿çº¿éªŒè¯](#è¿çº¿éªŒè¯)
5. [æµ‹è¯•éªŒè¯](#æµ‹è¯•éªŒè¯)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬1æ­¥ï¼šå¯¼å…¥å·¥ä½œæµ

1. ç™»å½•ä½ çš„N8Nå®ä¾‹
2. ç‚¹å‡»å³ä¸Šè§’ **"Import from File"** æˆ– **"ä»æ–‡ä»¶å¯¼å…¥"**
3. é€‰æ‹©æ–‡ä»¶ï¼š`docs/n8n-workflows/AIæœè£…å¹³å°-åŒè½¨å·¥ä½œæµ-æœ€ç»ˆç‰ˆ.json`
4. ç‚¹å‡» **"Import"** æˆ– **"å¯¼å…¥"**

### ç¬¬2æ­¥ï¼šæŸ¥çœ‹å·¥ä½œæµç»“æ„

å¯¼å…¥åä½ ä¼šçœ‹åˆ°ä»¥ä¸‹èŠ‚ç‚¹ç»“æ„ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€ä¿®æ”¹ã€‘Webhookæ¥æ”¶  â”‚ âš ï¸ éœ€è¦é…ç½®Webhook URL
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æå–è¯·æ±‚å‚æ•°      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
     â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚åˆ¤æ–­ï¼šåœºæ™¯â”‚  â”‚åˆ¤æ–­ï¼šè™šæ‹Ÿâ”‚
â”‚ç”Ÿå›¾ï¼Ÿ    â”‚  â”‚è¯•è¡£ï¼Ÿ    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚             â”‚
     â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ä¸‹è½½å•†å“å›¾â”‚   â”‚ä¸‹è½½æ¨¡ç‰¹å›¾â”‚
â”‚ä¸‹è½½åœºæ™¯å›¾â”‚   â”‚ä¸‹è½½æœè£…å›¾â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚             â”‚
     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
            â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ã€ä¿®æ”¹ã€‘AIç”Ÿæˆâ”‚ âš ï¸ éœ€è¦é…ç½®API
     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ã€ä¿®æ”¹ã€‘ä¸Šä¼   â”‚ âš ï¸ éœ€è¦é…ç½®API
     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ã€ä¿®æ”¹ã€‘å›è°ƒ  â”‚ âš ï¸ éœ€è¦é…ç½®URL
     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Webhookå“åº”  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš ï¸ éœ€è¦ä¿®æ”¹çš„å‚æ•°æ¸…å•

### ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼ˆå¿…é¡»ä¿®æ”¹ï¼‰

| èŠ‚ç‚¹åç§°                    | å‚æ•°ä½ç½®   | å‚æ•°å           | ç¤ºä¾‹å€¼                                             |
| --------------------------- | ---------- | ---------------- | -------------------------------------------------- |
| **ã€ä¿®æ”¹ã€‘Webhookæ¥æ”¶**     | èŠ‚ç‚¹è®¾ç½®   | Path             | `ai-clothing`                                      |
| **ã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-åœºæ™¯ç”Ÿå›¾** | ä»£ç ç¬¬2è¡Œ  | `AI_API_URL`     | `https://your-ai-api.com/generate`                 |
| **ã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-åœºæ™¯ç”Ÿå›¾** | ä»£ç ç¬¬3è¡Œ  | `AI_API_KEY`     | `your-api-key-here`                                |
| **ã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-åœºæ™¯ç”Ÿå›¾** | ä»£ç ç¬¬10è¡Œ | `model`          | `FLUX.1`                                           |
| **ã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-è™šæ‹Ÿè¯•è¡£** | ä»£ç ç¬¬2è¡Œ  | `TRYON_API_URL`  | `https://your-tryon-api.com/generate`              |
| **ã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-è™šæ‹Ÿè¯•è¡£** | ä»£ç ç¬¬3è¡Œ  | `TRYON_API_KEY`  | `your-tryon-api-key-here`                          |
| **ã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-è™šæ‹Ÿè¯•è¡£** | ä»£ç ç¬¬10è¡Œ | `model`          | `VITON`                                            |
| **ã€ä¿®æ”¹ã€‘ä¸Šä¼ ç»“æœå›¾**      | ä»£ç ç¬¬2è¡Œ  | `UPLOAD_API_URL` | `https://api.deerapi.com/upload`                   |
| **ã€ä¿®æ”¹ã€‘ä¸Šä¼ ç»“æœå›¾**      | ä»£ç ç¬¬3è¡Œ  | `UPLOAD_API_KEY` | `your-deerapi-key-here`                            |
| **ã€ä¿®æ”¹ã€‘å›è°ƒé€šçŸ¥**        | URL        | `url`            | `http://your-domain.com/api/webhooks/n8n/callback` |

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆå»ºè®®ä¿®æ”¹ï¼‰

| èŠ‚ç‚¹åç§°                | å‚æ•°ä½ç½® | å‚æ•°å         | è¯´æ˜               |
| ----------------------- | -------- | -------------- | ------------------ |
| **ã€ä¿®æ”¹ã€‘Webhookæ¥æ”¶** | èŠ‚ç‚¹è®¾ç½® | Authentication | å»ºè®®æ·»åŠ Headerè®¤è¯ |
| **ã€ä¿®æ”¹ã€‘å›è°ƒé€šçŸ¥**    | Headers  | è‡ªå®šä¹‰Header   | æ·»åŠ è®¤è¯å¯†é’¥       |

---

## ğŸ“– èŠ‚ç‚¹è¯¦ç»†é…ç½®

### èŠ‚ç‚¹1ï¼šã€ä¿®æ”¹ã€‘Webhookæ¥æ”¶

**åŠŸèƒ½ï¼š** æ¥æ”¶æ¥è‡ªå‰ç«¯çš„AIç”Ÿæˆè¯·æ±‚

**é…ç½®æ­¥éª¤ï¼š**

1. ç‚¹å‡»èŠ‚ç‚¹è¿›å…¥ç¼–è¾‘æ¨¡å¼
2. **HTTP Method**: é€‰æ‹© `POST`
3. **Path**: è¾“å…¥ `ai-clothing`ï¼ˆæˆ–ä½ è‡ªå®šä¹‰çš„è·¯å¾„ï¼‰
4. **Response Mode**: é€‰æ‹© `Using 'Respond to Webhook' Node`
5. **Authentication** (å¯é€‰):
   - é€‰æ‹© `Header Auth`
   - æ·»åŠ å¯†é’¥éªŒè¯ï¼š`X-Webhook-Token`

**è·å–Webhook URLï¼š**
é…ç½®å®Œæˆåï¼Œç‚¹å‡»èŠ‚ç‚¹å³ä¸Šè§’çš„ **"Production URL"** æˆ– **"ç”Ÿäº§URL"** å¤åˆ¶URLï¼Œæ ¼å¼ç±»ä¼¼ï¼š

```
https://your-n8n-instance.com/webhook/ai-clothing
```

**æ›´æ–°åˆ°é¡¹ç›®ç¯å¢ƒå˜é‡ï¼š**

```bash
# ç¼–è¾‘ .env.local æ–‡ä»¶
N8N_WEBHOOK_URL=https://your-n8n-instance.com/webhook/ai-clothing
```

---

### èŠ‚ç‚¹2ï¼šæå–è¯·æ±‚å‚æ•°

**åŠŸèƒ½ï¼š** ä»Webhookè¯·æ±‚ä½“ä¸­æå–å‚æ•°

**æ— éœ€ä¿®æ”¹** - è¯¥èŠ‚ç‚¹è‡ªåŠ¨æå–ä»¥ä¸‹å‚æ•°ï¼š

- `mode`: æ¨¡å¼ï¼ˆscene/tryonï¼‰
- `taskId`: ä»»åŠ¡ID
- `userId`: ç”¨æˆ·ID
- `prompt`: æç¤ºè¯
- `aspectRatio`: å®½é«˜æ¯”
- `imageCount`: å›¾ç‰‡æ•°é‡
- `quality`: è´¨é‡
- `productImageUrl`: å•†å“å›¾ç‰‡URLï¼ˆåœºæ™¯æ¨¡å¼ï¼‰
- `sceneImageUrl`: åœºæ™¯å›¾ç‰‡URLï¼ˆåœºæ™¯æ¨¡å¼ï¼‰
- `modelImageUrl`: æ¨¡ç‰¹å›¾ç‰‡URLï¼ˆè¯•è¡£æ¨¡å¼ï¼‰
- `clothingImageUrl`: æœè£…å›¾ç‰‡URLï¼ˆè¯•è¡£æ¨¡å¼ï¼‰

---

### èŠ‚ç‚¹3ï¼šåˆ¤æ–­ï¼šåœºæ™¯ç”Ÿå›¾ï¼Ÿ

**åŠŸèƒ½ï¼š** åˆ¤æ–­æ˜¯å¦ä¸ºåœºæ™¯ç”Ÿå›¾æ¨¡å¼

**æ¡ä»¶è®¾ç½®ï¼š**

```
Left Value: {{ $json.mode }}
Operation: Equals
Right Value: scene
```

**Trueè¾“å‡º**: æ‰§è¡Œåœºæ™¯ç”Ÿå›¾æµç¨‹
**Falseè¾“å‡º**: è·³åˆ°ä¸‹ä¸€ä¸ªåˆ¤æ–­èŠ‚ç‚¹

---

### èŠ‚ç‚¹4ï¼šåˆ¤æ–­ï¼šè™šæ‹Ÿè¯•è¡£ï¼Ÿ

**åŠŸèƒ½ï¼š** åˆ¤æ–­æ˜¯å¦ä¸ºè™šæ‹Ÿè¯•è¡£æ¨¡å¼

**æ¡ä»¶è®¾ç½®ï¼š**

```
Left Value: {{ $json.mode }}
Operation: Equals
Right Value: tryon
```

**Trueè¾“å‡º**: æ‰§è¡Œè™šæ‹Ÿè¯•è¡£æµç¨‹
**Falseè¾“å‡º**: è®¾ç½®ä¸ºä¸æ”¯æŒçš„æ¨¡å¼é”™è¯¯

---

### èŠ‚ç‚¹5-6ï¼šä¸‹è½½å›¾ç‰‡ï¼ˆ4ä¸ªèŠ‚ç‚¹ï¼‰

**åŠŸèƒ½ï¼š** ä»URLä¸‹è½½å›¾ç‰‡ä¸ºäºŒè¿›åˆ¶æ•°æ®

**é…ç½®ï¼š**

- `ä¸‹è½½å•†å“å›¾`: URL = `{{ $json.productImageUrl }}`
- `ä¸‹è½½åœºæ™¯å›¾`: URL = `{{ $json.sceneImageUrl }}`
- `ä¸‹è½½æ¨¡ç‰¹å›¾`: URL = `{{ $json.modelImageUrl }}`
- `ä¸‹è½½æœè£…å›¾`: URL = `{{ $json.clothingImageUrl }}`

**Response Format**: é€‰æ‹© `File`

---

### èŠ‚ç‚¹7ï¼šã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-åœºæ™¯ç”Ÿå›¾

**åŠŸèƒ½ï¼š** è°ƒç”¨AI APIç”Ÿæˆåœºæ™¯å›¾

**âš ï¸ å¿…é¡»ä¿®æ”¹çš„å‚æ•°ï¼š**

ç‚¹å‡»èŠ‚ç‚¹ï¼Œç¼–è¾‘JavaScriptä»£ç ï¼š

```javascript
// ==================== é…ç½®åŒºåŸŸ ====================
const AI_API_URL = 'https://your-ai-api.com/generate'; // âš ï¸ ä¿®æ”¹ä¸ºä½ çš„AI APIåœ°å€
const AI_API_KEY = 'your-api-key-here'; // âš ï¸ ä¿®æ”¹ä¸ºä½ çš„APIå¯†é’¥
const MODEL_ID = 'FLUX.1'; // âš ï¸ ä¿®æ”¹ä¸ºä½ çš„æ¨¡å‹ID
// ==================================================

const requestBody = {
  model: MODEL_ID,
  prompt: $input.item.json.prompt,
  product_image: $input.item.json.binary.productImage.data,
  scene_image: $input.item.json.binary.sceneImage.data,
  aspect_ratio: $input.item.json.aspectRatio || '1:1',
  num_images: $input.item.json.imageCount || 4,
  quality: $input.item.json.quality || 'high',
};

// å‘é€è¯·æ±‚
const response = await fetch(AI_API_URL, {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    Authorization: `Bearer ${AI_API_KEY}`,
  },
  body: JSON.stringify(requestBody),
});

const result = await response.json();

return {
  json: {
    taskId: $input.item.json.taskId,
    mode: 'scene',
    success: result.success || true,
    images: result.images || [],
    message: result.message || 'ç”ŸæˆæˆåŠŸ',
  },
};
```

**æ ¹æ®ä½ çš„AI APIè°ƒæ•´ï¼š**

- è¯·æ±‚ä½“æ ¼å¼
- è®¤è¯æ–¹å¼
- å“åº”æ•°æ®ç»“æ„

---

### èŠ‚ç‚¹8ï¼šã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-è™šæ‹Ÿè¯•è¡£

**åŠŸèƒ½ï¼š** è°ƒç”¨è™šæ‹Ÿè¯•è¡£APIç”Ÿæˆè¯•è¡£å›¾

**âš ï¸ å¿…é¡»ä¿®æ”¹çš„å‚æ•°ï¼š**

```javascript
// ==================== é…ç½®åŒºåŸŸ ====================
const TRYON_API_URL = 'https://your-tryon-api.com/generate'; // âš ï¸ ä¿®æ”¹
const TRYON_API_KEY = 'your-tryon-api-key-here'; // âš ï¸ ä¿®æ”¹
const MODEL_ID = 'VITON'; // âš ï¸ ä¿®æ”¹
// ==================================================

const requestBody = {
  model: MODEL_ID,
  prompt: $input.item.json.prompt,
  model_image: $input.item.json.binary.modelImage.data,
  clothing_image: $input.item.json.binary.clothingImage.data,
  num_images: $input.item.json.imageCount || 4,
  quality: $input.item.json.quality || 'high',
};

// å‘é€è¯·æ±‚
const response = await fetch(TRYON_API_URL, {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    Authorization: `Bearer ${TRYON_API_KEY}`,
  },
  body: JSON.stringify(requestBody),
});

const result = await response.json();

return {
  json: {
    taskId: $input.item.json.taskId,
    mode: 'tryon',
    success: result.success || true,
    images: result.images || [],
    message: result.message || 'ç”ŸæˆæˆåŠŸ',
  },
};
```

---

### èŠ‚ç‚¹9ï¼šã€ä¿®æ”¹ã€‘ä¸Šä¼ ç»“æœå›¾

**åŠŸèƒ½ï¼š** å°†ç”Ÿæˆçš„å›¾ç‰‡ä¸Šä¼ åˆ°å›¾åºŠ

**âš ï¸ å¿…é¡»ä¿®æ”¹çš„å‚æ•°ï¼š**

```javascript
// ==================== é…ç½®åŒºåŸŸ ====================
const UPLOAD_API_URL = 'https://api.deerapi.com/upload'; // âš ï¸ ä¿®æ”¹ä¸ºä½ çš„å›¾åºŠAPI
const UPLOAD_API_KEY = 'your-deerapi-key-here'; // âš ï¸ ä¿®æ”¹ä¸ºä½ çš„APIå¯†é’¥
// ==================================================

const images = $input.item.json.images || [];
const uploadedUrls = [];

// æ ¹æ®ä½ çš„å›¾åºŠAPIè°ƒæ•´ä¸Šä¼ é€»è¾‘
for (const imageData of images) {
  try {
    const formData = new FormData();

    // å¦‚æœimageDataæ˜¯base64
    if (imageData.startsWith('data:image')) {
      const base64Data = imageData.split(',')[1];
      const byteCharacters = atob(base64Data);
      const byteNumbers = new Array(byteCharacters.length);
      for (let i = 0; i < byteCharacters.length; i++) {
        byteNumbers[i] = byteCharacters.charCodeAt(i);
      }
      const byteArray = new Uint8Array(byteNumbers);
      const blob = new Blob([byteArray], { type: 'image/jpeg' });
      formData.append('file', blob, 'result.jpg');
    } else {
      // å¦‚æœæ˜¯URLæˆ–å…¶ä»–æ ¼å¼
      formData.append('file', imageData);
    }

    const response = await fetch(UPLOAD_API_URL, {
      method: 'POST',
      headers: {
        Authorization: `Bearer ${UPLOAD_API_KEY}`,
      },
      body: formData,
    });

    const result = await response.json();
    uploadedUrls.push(result.url || result.data?.url);
  } catch (error) {
    console.error('å›¾ç‰‡ä¸Šä¼ å¤±è´¥:', error);
  }
}

return {
  json: {
    ...$input.item.json,
    resultImageUrls: uploadedUrls,
    uploadCount: uploadedUrls.length,
  },
};
```

---

### èŠ‚ç‚¹10ï¼šã€ä¿®æ”¹ã€‘å›è°ƒé€šçŸ¥

**åŠŸèƒ½ï¼š** é€šçŸ¥å‰ç«¯ä»»åŠ¡å®Œæˆ

**âš ï¸ å¿…é¡»ä¿®æ”¹çš„å‚æ•°ï¼š**

1. **URL**: ä¿®æ”¹ä¸ºä½ çš„å›è°ƒåœ°å€

   ```
   http://your-domain.com/api/webhooks/n8n/callback
   ```

2. **Method**: `POST`

3. **Request Body** (JSONæ ¼å¼):

   ```json
   {
     "taskId": "{{ $json.taskId }}",
     "mode": "{{ $json.mode }}",
     "status": "COMPLETED",
     "resultImageUrls": "{{ $json.resultImageUrls }}",
     "message": "{{ $json.message }}"
   }
   ```

4. **Authentication** (å¯é€‰):
   - å¦‚æœéœ€è¦è®¤è¯ï¼Œæ·»åŠ Header:
     ```
     X-Callback-Token: your-callback-secret
     ```

---

### èŠ‚ç‚¹11ï¼šWebhookå“åº”

**åŠŸèƒ½ï¼š** ç«‹å³å“åº”Webhookè¯·æ±‚

**æ— éœ€ä¿®æ”¹** - è‡ªåŠ¨è¿”å›ï¼š

```json
{
  "success": true,
  "message": "ä»»åŠ¡å·²æ¥æ”¶",
  "taskId": "xxx",
  "mode": "scene"
}
```

---

### èŠ‚ç‚¹12ï¼šè®¾ç½®é”™è¯¯-ä¸æ”¯æŒçš„æ¨¡å¼

**åŠŸèƒ½ï¼š** å¤„ç†ä¸æ”¯æŒçš„æ¨¡å¼

**æ— éœ€ä¿®æ”¹** - è‡ªåŠ¨è¿”å›é”™è¯¯ä¿¡æ¯

---

## ğŸ”— è¿çº¿éªŒè¯

### æ£€æŸ¥è¿çº¿

åœ¨N8Nå·¥ä½œæµç¼–è¾‘å™¨ä¸­ï¼Œç¡®è®¤ä»¥ä¸‹è¿çº¿å­˜åœ¨ï¼š

**ä¸»çº¿æµç¨‹ï¼š**

1. âœ… `ã€ä¿®æ”¹ã€‘Webhookæ¥æ”¶` â†’ `æå–è¯·æ±‚å‚æ•°`
2. âœ… `æå–è¯·æ±‚å‚æ•°` â†’ `åˆ¤æ–­ï¼šåœºæ™¯ç”Ÿå›¾ï¼Ÿ`
3. âœ… `æå–è¯·æ±‚å‚æ•°` â†’ `åˆ¤æ–­ï¼šè™šæ‹Ÿè¯•è¡£ï¼Ÿ`

**åœºæ™¯ç”Ÿå›¾åˆ†æ”¯ï¼š** 4. âœ… `åˆ¤æ–­ï¼šåœºæ™¯ç”Ÿå›¾ï¼Ÿ` (True) â†’ `ä¸‹è½½å•†å“å›¾` 5. âœ… `åˆ¤æ–­ï¼šåœºæ™¯ç”Ÿå›¾ï¼Ÿ` (True) â†’ `ä¸‹è½½åœºæ™¯å›¾` 6. âœ… `ä¸‹è½½å•†å“å›¾` â†’ `ã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-åœºæ™¯ç”Ÿå›¾` 7. âœ… `ä¸‹è½½åœºæ™¯å›¾` â†’ `ã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-åœºæ™¯ç”Ÿå›¾`

**è™šæ‹Ÿè¯•è¡£åˆ†æ”¯ï¼š** 8. âœ… `åˆ¤æ–­ï¼šè™šæ‹Ÿè¯•è¡£ï¼Ÿ` (True) â†’ `ä¸‹è½½æ¨¡ç‰¹å›¾` 9. âœ… `åˆ¤æ–­ï¼šè™šæ‹Ÿè¯•è¡£ï¼Ÿ` (True) â†’ `ä¸‹è½½æœè£…å›¾` 10. âœ… `ä¸‹è½½æ¨¡ç‰¹å›¾` â†’ `ã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-è™šæ‹Ÿè¯•è¡£` 11. âœ… `ä¸‹è½½æœè£…å›¾` â†’ `ã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-è™šæ‹Ÿè¯•è¡£`

**åˆå¹¶æµç¨‹ï¼š** 12. âœ… `ã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-åœºæ™¯ç”Ÿå›¾` â†’ `ã€ä¿®æ”¹ã€‘ä¸Šä¼ ç»“æœå›¾` 13. âœ… `ã€ä¿®æ”¹ã€‘AIç”Ÿæˆ-è™šæ‹Ÿè¯•è¡£` â†’ `ã€ä¿®æ”¹ã€‘ä¸Šä¼ ç»“æœå›¾` 14. âœ… `ã€ä¿®æ”¹ã€‘ä¸Šä¼ ç»“æœå›¾` â†’ `ã€ä¿®æ”¹ã€‘å›è°ƒé€šçŸ¥` 15. âœ… `ã€ä¿®æ”¹ã€‘å›è°ƒé€šçŸ¥` â†’ `Webhookå“åº”`

**é”™è¯¯å¤„ç†ï¼š** 16. âœ… `åˆ¤æ–­ï¼šåœºæ™¯ç”Ÿå›¾ï¼Ÿ` (False) â†’ `è®¾ç½®é”™è¯¯-ä¸æ”¯æŒçš„æ¨¡å¼` 17. âœ… `åˆ¤æ–­ï¼šè™šæ‹Ÿè¯•è¡£ï¼Ÿ` (False) â†’ `è®¾ç½®é”™è¯¯-ä¸æ”¯æŒçš„æ¨¡å¼` 18. âœ… `è®¾ç½®é”™è¯¯-ä¸æ”¯æŒçš„æ¨¡å¼` â†’ `Webhookå“åº”`

### ä¿å­˜å·¥ä½œæµ

1. ç‚¹å‡»å³ä¸Šè§’ **"Save"** æˆ– **"ä¿å­˜"**
2. ç‚¹å‡» **"Active"** æˆ– **"æ¿€æ´»"** å¼€å…³ï¼Œç¡®ä¿å·¥ä½œæµå¤„äºæ¿€æ´»çŠ¶æ€

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•1: åœºæ™¯ç”Ÿå›¾æ¨¡å¼

```bash
curl -X POST YOUR_N8N_WEBHOOK_URL \
  -H "Content-Type: application/json" \
  -d '{
    "mode": "scene",
    "taskId": "test-scene-001",
    "userId": "test-user",
    "productImageUrl": "https://picsum.photos/seed/product/512/512",
    "sceneImageUrl": "https://picsum.photos/seed/scene/512/512",
    "prompt": "æ—¶å°šæ¨¡ç‰¹åœ¨ç°ä»£å’–å•¡å…",
    "aspectRatio": "1:1",
    "imageCount": 2,
    "quality": "high"
  }'
```

**é¢„æœŸå“åº”ï¼š**

```json
{
  "success": true,
  "message": "ä»»åŠ¡å·²æ¥æ”¶",
  "taskId": "test-scene-001",
  "mode": "scene"
}
```

### æµ‹è¯•2: è™šæ‹Ÿè¯•è¡£æ¨¡å¼

```bash
curl -X POST YOUR_N8N_WEBHOOK_URL \
  -H "Content-Type: application/json" \
  -d '{
    "mode": "tryon",
    "taskId": "test-tryon-001",
    "userId": "test-user",
    "modelImageUrl": "https://picsum.photos/seed/model/512/512",
    "clothingImageUrl": "https://picsum.photos/seed/clothing/512/512",
    "prompt": "çº¢è‰²è¿è¡£è£™",
    "imageCount": 2,
    "quality": "high"
  }'
```

### æµ‹è¯•3: ä¸æ”¯æŒçš„æ¨¡å¼

```bash
curl -X POST YOUR_N8N_WEBHOOK_URL \
  -H "Content-Type: application/json" \
  -d '{
    "mode": "unsupported",
    "taskId": "test-error-001",
    "userId": "test-user"
  }'
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: WebhookèŠ‚ç‚¹æ˜¾ç¤º"Waiting for webhook"

**A:** è¿™æ˜¯æ­£å¸¸çš„ã€‚ä¿å­˜å¹¶æ¿€æ´»å·¥ä½œæµåï¼ŒWebhookä¼šè‡ªåŠ¨ç›‘å¬ã€‚å¯ä»¥é€šè¿‡å‘é€æµ‹è¯•è¯·æ±‚æ¥éªŒè¯ã€‚

### Q2: å›¾ç‰‡ä¸‹è½½å¤±è´¥

**A:** æ£€æŸ¥ï¼š

- å›¾ç‰‡URLæ˜¯å¦å¯å…¬å¼€è®¿é—®
- æ˜¯å¦æœ‰CORSé™åˆ¶
- N8NæœåŠ¡å™¨æ˜¯å¦æœ‰ç½‘ç»œè®¿é—®æƒé™

### Q3: AIç”ŸæˆèŠ‚ç‚¹æŠ¥é”™

**A:** æ£€æŸ¥ï¼š

- API_URLæ˜¯å¦æ­£ç¡®
- API_KEYæ˜¯å¦æœ‰æ•ˆ
- è¯·æ±‚ä½“æ ¼å¼æ˜¯å¦ç¬¦åˆAPIè¦æ±‚
- å“åº”æ•°æ®ç»“æ„æ˜¯å¦æ­£ç¡®

### Q4: å›è°ƒå¤±è´¥

**A:** æ£€æŸ¥ï¼š

- å›è°ƒURLæ˜¯å¦å¯è®¿é—®
- é˜²ç«å¢™æ˜¯å¦é˜»æ­¢N8NæœåŠ¡å™¨è®¿é—®
- æ˜¯å¦éœ€è¦è®¤è¯å¯†é’¥

### Q5: å¦‚ä½•æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—ï¼Ÿ

**A:**

1. ç‚¹å‡»å·¦ä¾§èœå• **"Executions"** æˆ– **"æ‰§è¡Œè®°å½•"**
2. æŸ¥çœ‹æ¯æ¬¡Webhookè§¦å‘çš„æ‰§è¡Œè¯¦æƒ…
3. ç‚¹å‡»æ¯ä¸ªèŠ‚ç‚¹æŸ¥çœ‹è¾“å…¥è¾“å‡ºæ•°æ®

---

## ğŸ“ é…ç½®æ£€æŸ¥æ¸…å•

å¯¼å…¥å·¥ä½œæµåï¼Œé€é¡¹æ£€æŸ¥ï¼š

- [ ] **Webhook URLå·²å¤åˆ¶** å¹¶æ›´æ–°åˆ° `.env.local`
- [ ] **AI_API_URL** å·²ä¿®æ”¹ä¸ºå®é™…çš„AI APIåœ°å€
- [ ] **AI_API_KEY** å·²è®¾ç½®ä¸ºæœ‰æ•ˆçš„APIå¯†é’¥
- [ ] **MODEL_ID** å·²è®¾ç½®ä¸ºæ­£ç¡®çš„æ¨¡å‹ID
- [ ] **TRYON_API_URL** å·²ä¿®æ”¹ä¸ºå®é™…çš„è™šæ‹Ÿè¯•è¡£APIåœ°å€
- [ ] **TRYON_API_KEY** å·²è®¾ç½®ä¸ºæœ‰æ•ˆçš„APIå¯†é’¥
- [ ] **UPLOAD_API_URL** å·²ä¿®æ”¹ä¸ºå›¾åºŠAPIåœ°å€
- [ ] **UPLOAD_API_KEY** å·²è®¾ç½®ä¸ºæœ‰æ•ˆçš„å›¾åºŠå¯†é’¥
- [ ] **å›è°ƒURL** å·²ä¿®æ”¹ä¸ºå®é™…åŸŸå
- [ ] **æ‰€æœ‰è¿çº¿** å·²éªŒè¯æ­£ç¡®
- [ ] **å·¥ä½œæµå·²æ¿€æ´»**
- [ ] **æµ‹è¯•è¯·æ±‚** å·²æˆåŠŸæ‰§è¡Œ

---

_æ–‡æ¡£åˆ›å»ºæ—¶é—´: 2026-01-29_
_å·¥ä½œæµç‰ˆæœ¬: v1.0.0_
