# 🚀 AI服装平台 - 完整系统Demo设计说明

## 📅 文档版本：v2.0

## 📅 更新日期：2026-01-29

---

## 🎯 概述

本文档描述**完整系统Demo**的设计，包含前端Web、N8N工作流、飞书多维表格的完整联动流程。

---

## 📊 系统架构

### 完整数据流

```
┌─────────────────────────────────────────────────────────────┐
│                     用户操作入口                             │
├─────────────────────────────────────────────────────────────┤
│  入口1: 前端Web界面                                          │
│  入口2: 飞书多维表格                                         │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│              第一步：上传产品图片                            │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ [拖拽上传] 或 [点击选择] 产品白底图                 │   │
│  │ ✅ 图片预览                                        │   │
│  │ ✅ 自动提取产品特征（颜色、类别）                   │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│           第二步：选择提示词模板                            │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ ◉ 服装模特展示 👔                                   │   │
│  │ ○ 产品静物展示 🏺                                   │   │
│  │ ○ 分层逻辑控制 🎯                                   │   │
│  │ ○ 自定义提示词 ✏️                                  │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│         第三步：填写模板参数（动态表单）                    │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 根据选择的模板，显示对应的表单字段                  │   │
│  │                                                       │   │
│  │ 【服装模特展示】示例：                                │   │
│  │  产品描述: [红色连衣裙________]                       │   │
│  │  模特类型: [年轻亚洲女性 ▼]                         │   │
│  │  场景风格: [温馨卧室 ▼]                             │   │
│  │                                                       │   │
│  │ 【产品静物展示】示例：                                │   │
│  │  产品描述: [陶瓷花瓶________]                        │   │
│  │  材质: [陶瓷 ▼]                                     │   │
│  │  表面处理: [哑光 ▼]                                 │   │
│  │  光线类型: [柔光箱 ▼]                               │   │
│  │  背景类型: [木纹桌面 ▼]                             │   │
│  │  构图视角: [3/4视角 ▼]                              │   │
│  │  拍摄风格: [极简主义 ▼]                             │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│       第四步：AI提示词优化（可选）⭐ NEW                    │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 💬 AI对话优化按钮                                   │   │
│  │                                                       │   │
│  │ 点击后打开AI对话界面：                                │   │
│  │ ┌──────────────────────────────────────────────┐   │   │
│  │ │ 💬 AI对话优化                                 │   │   │
│  │ │ ──────────────────────────────────────────  │   │   │
│  │ │ 系统生成的提示词：                            │   │   │
│  │ │ [显示当前生成的提示词]                        │   │   │
│  │ │                                                │   │   │
│  │ │ 您: 请让场景更温馨一些                         │   │   │
│  │ │ AI: 好的，我来调整场景描述...                  │   │   │
│  │ │ [AI优化后的提示词]                             │   │   │
│  │ │                                                │   │   │
│  │ │ 版本选择：                                     │   │   │
│  │ │ ○ 使用模板生成版                               │   │   │
│  │ │ ◉ 使用AI优化版                                 │   │   │
│  │ └──────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│       第五步：生成参数预览 & 提交                           │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 📋 生成参数预览                                    │   │
│  │ ┌──────────────────────────────────────────────┐   │   │
│  │ │ 模板类型: 服装模特展示                        │   │   │
│  │ │ 产品描述: 红色连衣裙                          │   │   │
│  │ │ 最终提示词: [预览前200字...]                  │   │   │
│  │ │ AI模型: Gemini-3-Pro-Image                   │   │   │
│  │ │ 尺寸比例: 3:4                                 │   │   │
│  │ │ 生成数量: 4张                                 │   │   │
│  │ │                                                │   │   │
│  │ │ 提示词来源: AI_OPTIMIZED                      │   │   │
│  │ └──────────────────────────────────────────────┘   │   │
│  │                                                       │   │
│  │ [🎨 开始生成图片]                                    │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│              第六步：N8N工作流处理                          │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ N8N工作流：ai-clothing-generation                  │   │
│  │                                                       │   │
│  │ Webhook接收 → 解析参数 → AI图片生成 → 回调通知      │   │
│  │                                                       │   │
│  │ 关键节点：                                           │   │
│  │ 1. Webhook: 接收前端请求                            │   │
│  │ 2. 解析前端参数: 提取所有字段                      │   │
│  │ 3. 选择最终提示词: 根据promptSource选择            │   │
│  │ 4. AI图片生成-前端: 调用DeerAPI                    │   │
│  │ 5. 创建飞书记录: 保存到飞书表格                    │   │
│  │ 6. 回调前端: 通知前端结果                          │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│              第七步：飞书多维表格记录                       │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 飞书多维表格：AI服装平台任务                       │   │
│  │                                                       │   │
│  │ 字段显示：                                           │   │
│  │ ┌─────────────────────────────────────────────┐    │   │
│  │ │ 记录ID   │ 任务状态 │ 提示词来源 │ AI对话  │    │   │
│  │ │ T-001   │ 处理中   │ AI_OPTIMIZED │ 💬 打开│    │   │
│  │ │         │          │              │        │    │   │
│  │ │ 产品图片 │ 原始提示词 │ 优化后提示词        │    │   │
│  │ │ [图片]  │ 红色连衣裙 │ An elegant red...   │    │   │
│  │ │         │          │                      │    │   │
│  │ │ AI模型  │ 尺寸比例 │ 生成结果 │ 创建时间  │    │   │
│  │ │ Gemini  │ 3:4     │ [待生成] │ 2026-01-29│    │   │
│  │ └─────────────────────────────────────────────┘    │   │
│  │                                                       │   │
│  │ 💬 AI对话按钮 → 跳转到AI对话界面                     │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│           第八步：图片生成完成 & 结果展示                   │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ ✅ 生成完成！                                       │   │
│  │                                                       │   │
│  │ 生成的4张图片：                                      │   │
│  │ ┌───┐ ┌───┐ ┌───┐ ┌───┐                           │   │
│  │ │ 1 │ │ 2 │ │ 3 │ │ 4 │                           │   │
│  │ └───┘ └───┘ └───┘ └───┘                           │   │
│  │                                                       │   │
│  │ [📥 下载全部] [🔄 重新生成] [📋 查看飞书记录]       │   │
│  │                                                       │   │
│  │ 飞书记录已更新 → [查看详情]                          │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

---

## 🎨 Demo页面结构

### 页面1: 主创建页面

```
┌─────────────────────────────────────────────────────────────┐
│ 🎨 AI服装平台                              [用户头像] [⚙️]  │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │  第1步：上传产品图片                                    │ │
│ │  ┌───────────────────────────────────────────────────┐ │ │
│ │  │                                                   │ │ │
│ │  │           📁                                     │ │ │
│ │  │   拖拽图片到这里，或点击上传                      │ │ │
│ │  │                                                   │ │ │
│ │  │              或                                  │ │ │
│ │  │                                                   │ │ │
│ │  │   [从飞书表格选择]  [使用示例图片]                │ │ │
│ │  │                                                   │ │ │
│ │  └───────────────────────────────────────────────────┘ │ │
│ │                                                         │ │
│ │  ✅ 图片特征自动提取：检测到「连衣裙」「红色」         │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                               │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │  第2步：选择提示词模板                                  │ │
│ │  ┌─────┐  ┌─────┐  ┌─────┐  ┌─────┐                 │ │
│ │  │ 👔  │  │ 🏺  │  │ 🎯  │  │ ✏️  │                 │ │
│ │  │服装 │  │产品 │  │分层 │  │自定义│                │ │
│ │  │模特 │  │静物 │  │逻辑 │  │提示词│                │ │
│ │  └─────┘  └─────┘  └─────┘  └─────┘                 │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                               │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │  第3步：填写参数                                         │ │
│ │  [动态表单区域 - 根据选择的模板显示]                   │ │
│ │                                                         │ │
│ │  产品描述:  [红色连衣裙________________]               │ │
│ │  模特类型:  [年轻亚洲女性 ▼]                          │ │
│ │  场景风格:  [温馨卧室 ▼]                              │ │
│ │                                                         │ │
│ │  💬 AI对话优化 → [打开]                                │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                               │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │  第4步：生成设置                                         │ │
│ │  AI模型:    [Gemini-3-Pro-Image ▼]                    │ │
│ │  尺寸比例:  [3:4 ▼]                                    │ │
│ │  生成数量:  [4张 ▼]                                    │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                               │
│                  [🎨 开始生成图片]                          │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

### 页面2: AI对话优化界面

```
┌─────────────────────────────────────────────────────────────┐
│ ← 返回          💬 AI对话优化                               │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │  当前提示词                                             │ │
│ │  ┌───────────────────────────────────────────────────┐ │ │
│ │  │ # Task Definition                                │ │ │
│ │  │                                                  │ │ │
│ │  │ 你是一位世界顶级的商业广告摄影师...              │ │ │
│ │  │                                                  │ │ │
│ │  │ **产品特征**：红色连衣裙                          │ │ │
│ │  │ **模特描述**：年轻亚洲女性                        │ │ │
│ │  │ **环境描述**：温馨卧室                            │ │ │
│ │  │                                                  │ │ │
│ │  │ [完整提示词内容...]                              │ │ │
│ │  └───────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                               │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │  对话历史                                               │ │
│ │  ┌───────────────────────────────────────────────────┐ │ │
│ │  │ 🤖 AI: 欢迎使用AI对话优化功能！您可以对当前的    │ │ │
│ │  │     提示词进行多轮优化，我会根据您的需求调整...   │ │ │
│ │  │                                                  │ │ │
│ │  │ 👤 您: 请让场景更温馨一些                         │ │ │
│ │  │                                                  │ │ │
│ │  │ 🤖 AI: 好的，我来调整场景描述，增加更温馨的元   │ │ │
│ │  │     素：柔化光线、增加暖色调、加入生活化道具...   │ │ │
│ │  │                                                  │ │ │
│ │  │ 👤 您: 可以加入一些书籍道具吗                     │ │ │
│ │  │                                                  │ │ │
│ │  │ 🤖 AI: 当然！我来在场景中加入书籍作为装饰道具...  │ │ │
│ │  └───────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                               │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │  发送消息                                               │ │
│ │  ┌─────────────────────────────────┐  [🚀 发送]        │ │
│ │  │ 继续描述您的需求...             │                   │ │
│ │  └─────────────────────────────────┘                   │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                               │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │  版本选择                                               │ │
│ │  ○ 使用模板生成版（原始版）                             │ │
│ │  ◉ 使用AI优化版（推荐）                                 │ │
│ │                                                         │ │
│ │  [👍 确认并返回]                                        │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

### 页面3: 生成结果页面

```
┌─────────────────────────────────────────────────────────────┐
│ ← 返回          ✅ 生成完成！                                │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │  生成的图片 (4张)                                       │ │
│ │  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐       │ │
│ │  │        │  │        │  │        │  │        │       │ │
│ │  │  图1   │  │  图2   │  │  图3   │  │  图4   │       │ │
│ │  │        │  │        │  │        │  │        │       │ │
│ │  │        │  │        │  │        │  │        │       │ │
│ │  └────────┘  └────────┘  └────────┘  └────────┘       │ │
│ │   [下载]    [下载]    [下载]    [下载]                  │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                               │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │  任务详情                                               │ │
│ │  • 任务ID: T-001                                        │ │
│ │  • 模板类型: 服装模特展示                               │ │
│ │  • 产品描述: 红色连衣裙                                 │ │
│ │  • 提示词来源: AI_OPTIMIZED                             │ │
│ │  • AI模型: Gemini-3-Pro-Image                          │ │
│ │  • 创建时间: 2026-01-29 10:30:00                       │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                               │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │  快捷操作                                               │ │
│ │  [📥 下载全部]  [🔄 重新生成]  [📋 查看飞书记录]       │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

### 飞书多维表格视图

```
┌─────────────────────────────────────────────────────────────┐
│ 📊 飞书多维表格 - AI服装平台任务                             │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  筛选: [全部 ▼]  排序: [创建时间 ↓ ▼]  搜索: [________]     │
│                                                               │
│ ┏━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┳━━━━━━━┓       │
│ ┃记录ID ┃任务状┃产品图┃提示词┃AI对话┃生成结┃       │       │
│ ┃       ┃态    ┃      ┃来源  ┃      ┃果    ┃       │       │
│ ┣━━━━━━━╋━━━━━━━╋━━━━━━━╋━━━━━━━╋━━━━━━━╋━━━━━━━┫       │
│ ┃T-001  ┃完成  ┃[图片]┃AI_OPTI┃💬打开┃[图片]┃       │       │
│ ┃       ┃      ┃      ┃MIZED  ┃      ┃      ┃       │       │
│ ┣━━━━━━━╋━━━━━━━╋━━━━━━━╋━━━━━━━╋━━━━━━━╋━━━━━━━┫       │
│ ┃T-002  ┃处理中┃[图片]┃USER   ┃💬打开┃-     ┃       │       │
│ ┃       ┃      ┃      ┃      ┃      ┃      ┃       │       │
│ ┣━━━━━━━╋━━━━━━━╋━━━━━━━╋━━━━━━━╋━━━━━━━╋━━━━━━━┫       │
│ ┃T-003  ┃失败  ┃[图片]┃TEMPL  ┃💬打开┃❌错误┃       │       │
│ ┃       ┃      ┃      ┐ATE   ┃      ┃      ┃       │       │
│ ┗━━━━━━━┻━━━━━━━┻━━━━━━━┻━━━━━━━┻━━━━━━━┻━━━━━━━┛       │
│                                                               │
│  [➕ 新建记录]  [📊 统计]  [⚙️ 设置]                         │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

---

## 🔄 核心交互流程

### 流程A: 前端Web创建任务（标准流程）

```
1. 用户访问前端页面
   ↓
2. 上传产品图片 → 系统自动提取特征
   ↓
3. 选择提示词模板（服装模特/产品静物/分层逻辑/自定义）
   ↓
4. 填写模板参数（动态表单）
   ↓
5. [可选] 点击"AI对话优化"按钮
   ↓
6. AI对话界面中进行多轮优化
   ↓
7. 选择使用模板版或AI优化版
   ↓
8. 返回主界面，显示最终提示词
   ↓
9. 配置生成设置（AI模型、尺寸、数量）
   ↓
10. 点击"开始生成图片"
   ↓
11. 前端调用API → 发送到N8N工作流
   ↓
12. N8N接收请求 → 选择最终提示词
   ↓
13. N8N调用DeerAPI生成图片
   ↓
14. N8N创建/更新飞书记录
   ↓
15. N8N回调前端，返回结果
   ↓
16. 前端显示生成结果
   ↓
17. 用户可以下载、重新生成、查看飞书记录
```

### 流程B: 飞书表格创建任务（快速流程）

```
1. 用户打开飞书多维表格
   ↓
2. 点击"新建记录"
   ↓
3. 填写基础字段：
   - 提示词
   - 产品图片
   - AI模型
   - 尺寸比例
   - 生成数量
   - 模板类型
   ↓
4. [可选] 点击"AI对话"URL按钮
   ↓
5. 跳转到AI对话优化界面
   ↓
6. 进行多轮对话优化
   ↓
7. 优化完成后，点击"确认"
   ↓
8. 飞书记录自动更新：
   - 优化后提示词
   - 提示词来源（AI_OPTIMIZED）
   ↓
9. 点击"点击按钮"触发飞书自动化
   ↓
10. 飞书自动化发送请求到N8N
   ↓
11. N8N接收请求 → 处理 → 生成图片
   ↓
12. N8N更新飞书记录（状态、生成结果）
   ↓
13. 用户在飞书中查看结果
```

### 流程C: AI对话优化流程

```
1. 用户在前端或飞书选择"AI对话优化"
   ↓
2. 打开AI对话界面
   ↓
3. 系统显示当前提示词（模板生成版）
   ↓
4. 用户输入优化需求（如："让场景更温馨"）
   ↓
5. AI分析需求，优化提示词
   ↓
6. 显示优化后的提示词
   ↓
7. 用户可以继续对话，多轮优化
   ↓
8. 满意后，选择最终版本：
   - 模板生成版
   - AI优化版
   ↓
9. 系统记录选择：
   - promptSource = "AI_OPTIMIZED" 或 "TEMPLATE"
   - 保存到数据库/飞书
   ↓
10. 返回主界面继续生成流程
```

---

## 🎯 关键交互点

### 交互点1: 图片上传与特征提取

**位置**: 第1步
**用户操作**: 上传产品图片
**系统响应**:

- 显示图片预览
- 自动提取产品特征（颜色、类别）
- 自动填充部分参数

**技术要点**:

- 支持拖拽上传
- 支持从飞书表格选择
- 图片格式验证
- 图片大小限制
- 自动提取特征（可使用AI视觉API）

### 交互点2: 模板选择与动态表单

**位置**: 第2-3步
**用户操作**: 选择模板，填写参数
**系统响应**:

- 根据模板显示对应表单
- 表单验证
- 实时生成提示词预览

**技术要点**:

- 动态表单切换
- 表单验证规则
- 参数关联逻辑
- 提示词实时生成

### 交互点3: AI对话优化

**位置**: 第3步（可选）
**用户操作**: 点击"AI对话优化"
**系统响应**:

- 打开AI对话界面
- 显示当前提示词
- 支持多轮对话
- 显示优化后提示词
- 版本选择

**技术要点**:

- AI对话API集成
- 对话历史记录
- 上下文保持
- 版本对比显示

### 交互点4: 提交生成

**位置**: 第4步
**用户操作**: 配置生成设置，点击"开始生成"
**系统响应**:

- 显示所有参数预览
- 验证必填项
- 提交到N8N
- 显示处理中状态

**技术要点**:

- 参数完整性验证
- 异步提交
- 轮询状态
- 错误处理

### 交互点5: 结果展示

**位置**: 第5步
**用户操作**: 查看生成结果
**系统响应**:

- 显示生成的图片
- 显示任务详情
- 提供快捷操作

**技术要点**:

- 图片懒加载
- 图片预览
- 批量下载
- 飞书记录跳转

---

## 📊 数据状态变化

### 前端Web任务状态

```
PENDING（待处理）
  ↓ 用户点击"开始生成"
PROCESSING（处理中）
  ↓ N8N处理完成
COMPLETED（已完成）或 FAILED（失败）
```

### 飞书记录状态

```
DRAFT（草稿）
  ↓ 用户填写字段
READY（准备就绪）
  ↓ 飞书自动化触发
PROCESSING（处理中）
  ↓ N8N更新记录
COMPLETED（已完成）或 FAILED（失败）
```

### 提示词来源

```
USER（用户自定义）
  ↓ 用户使用自定义提示词
TEMPLATE（模板生成）
  ↓ 用户使用模板生成的提示词
AI_OPTIMIZED（AI优化）
  ↓ 用户选择AI优化版
FEISHU（飞书表格输入）
  ↓ 从飞书表格创建
```

---

## 🎨 UI/UX设计要点

### 设计原则

1. **简洁优先**: 保持界面整洁，避免信息过载
2. **流程清晰**: 分步骤引导用户完成操作
3. **即时反馈**: 每个操作都有明确的反馈
4. **容错性强**: 支持撤销、修改、重新生成
5. **多端适配**: 支持桌面和移动设备

### 交互细节

1. **上传图片**:
   - 支持拖拽和点击上传
   - 实时预览
   - 显示提取的特征

2. **模板选择**:
   - 卡片式布局
   - 悬浮效果
   - 清晰的适用场景说明

3. **动态表单**:
   - 根据模板平滑切换
   - 输入提示
   - 实时验证

4. **AI对话**:
   - 对话气泡样式
   - 打字效果
   - 版本对比高亮

5. **结果展示**:
   - 图片网格布局
   - 悬浮显示详情
   - 快捷操作按钮

---

## ✅ Demo验证清单

在验证Demo时，请确认以下功能：

### 基础功能

- [ ] 可以上传产品图片
- [ ] 可以选择4个模板
- [ ] 可以填写动态表单
- [ ] 可以生成提示词
- [ ] 可以配置生成设置
- [ ] 可以提交生成

### AI优化功能

- [ ] 可以打开AI对话界面
- [ ] 可以进行多轮对话
- [ ] 可以查看优化后的提示词
- [ ] 可以选择模板版或优化版
- [ ] 选择后正确记录到参数中

### 结果展示

- [ ] 可以查看生成的图片
- [ ] 可以下载图片
- [ ] 可以重新生成
- [ ] 可以跳转到飞书记录
- [ ] 可以查看任务详情

### 飞书集成

- [ ] 可以在飞书中查看记录
- [ ] 可以在飞书中点击AI对话
- [ ] 可以在飞书中触发生成
- [ ] 可以在飞书中查看结果

---

此Demo设计涵盖了完整系统的所有核心功能，用于验证全局需求。
